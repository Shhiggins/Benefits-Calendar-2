<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PayPal Global Benefits Calendar 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;scroll-behavior:smooth}
:root{--pp-blue:#0070BA;--pp-dark:#003087;--pp-navy:#003087;--pp-light-blue:#009CDE;--pp-white:#FFFFFF;--pp-black:#000000;--pp-gray-50:#F8FAFC;--pp-gray-100:#F1F5F9;--pp-gray-200:#E2E8F0;--pp-gray-300:#CBD5E1;--pp-gray-400:#94A3B8;--pp-gray-500:#64748B;--pp-gray-600:#475569;--pp-gray-800:#1E293B;--pp-gray-900:#0F172A;--pp-card-bg:#FFFFFF;--pp-text:#0F172A;--pp-text-muted:#64748B;--pp-border:#E2E8F0;--pp-shadow:0 1px 3px rgba(0,0,0,0.08);--pp-gradient:linear-gradient(135deg,#003087 0%,#0070BA 50%,#009CDE 100%);--pp-radius:12px;--pp-input-bg:#FFFFFF;--pp-modal-bg:#FFFFFF;--pp-physical:#0070BA;--pp-financial:#22C55E;--pp-emotional:#8B5CF6}
[data-theme="dark"]{--pp-white:#0F172A;--pp-gray-50:#1E293B;--pp-gray-100:#334155;--pp-gray-200:#475569;--pp-gray-300:#64748B;--pp-gray-400:#94A3B8;--pp-gray-500:#CBD5E1;--pp-gray-600:#E2E8F0;--pp-gray-800:#F1F5F9;--pp-gray-900:#F8FAFC;--pp-card-bg:#1E293B;--pp-text:#F8FAFC;--pp-text-muted:#CBD5E1;--pp-border:#475569;--pp-input-bg:#334155;--pp-modal-bg:#1E293B}
body{font-family:'Space Grotesk',system-ui,sans-serif;background:var(--pp-gray-100);min-height:100vh;color:var(--pp-text);line-height:1.5}
.container{max-width:1600px;margin:0 auto;background:var(--pp-white);min-height:100vh}
.header{background:var(--pp-gradient);color:#fff;padding:0;position:sticky;top:0;z-index:100}
.header-top{display:flex;justify-content:space-between;align-items:center;padding:12px 24px;flex-wrap:wrap;gap:10px}
.header-left{display:flex;align-items:center;gap:16px}
.logo svg{height:28px}
.header-title h1{font-size:1rem;font-weight:700;letter-spacing:-0.02em}
.header-title p{font-size:0.68rem;opacity:0.9;font-weight:500}
.header-right{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.btn{padding:7px 14px;border-radius:8px;cursor:pointer;font-weight:600;font-size:0.75rem;border:none;display:inline-flex;align-items:center;gap:5px;transition:all 0.25s;font-family:inherit}
.btn:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.15)}
.btn-glass{background:rgba(255,255,255,0.15);color:#fff;border:1px solid rgba(255,255,255,0.2)}
.btn-glass:hover{background:rgba(255,255,255,0.25)}
.btn-white{background:#fff;color:var(--pp-navy)}
.btn-admin{background:var(--pp-black);color:#fff}.btn-admin.active{background:#DC2626}
.btn-danger{background:#DC2626;color:#fff}
.btn-success{background:#22C55E;color:#fff}
.btn-primary{background:var(--pp-blue);color:#fff}
.btn-secondary{background:var(--pp-gray-200);color:var(--pp-text)}
.view-toggle{display:flex;background:rgba(0,0,0,0.2);border-radius:8px;padding:2px}
.view-btn{padding:5px 12px;background:transparent;color:rgba(255,255,255,0.8);border:none;cursor:pointer;font-family:inherit;font-weight:600;font-size:0.7rem;border-radius:6px;transition:all 0.3s}
.view-btn:hover{color:#fff;background:rgba(255,255,255,0.15)}
.view-btn.active{background:#fff;color:var(--pp-navy);box-shadow:0 2px 8px rgba(0,0,0,0.15)}
.search-box{display:flex;align-items:center;background:#fff;border-radius:8px;padding:0 10px;gap:6px}
.search-box input{border:none;padding:8px 0;font-size:0.8rem;width:140px;font-family:inherit;outline:none;color:var(--pp-black);background:transparent}
.filters{background:var(--pp-card-bg);padding:14px 24px;border-bottom:1px solid var(--pp-border)}
.filters-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:10px;align-items:end}
.filter-group{display:flex;flex-direction:column;gap:3px}
.filter-group label{font-weight:600;color:var(--pp-text-muted);font-size:0.65rem;text-transform:uppercase;letter-spacing:0.03em;cursor:help}
.filter-group select,.filter-group input{padding:8px 10px;border:2px solid var(--pp-border);border-radius:8px;font-size:0.8rem;background:var(--pp-input-bg);font-family:inherit;font-weight:500;color:var(--pp-text)}
.filter-group select:focus,.filter-group input:focus{border-color:var(--pp-blue);outline:none}
.filter-group textarea{padding:8px 10px;border:2px solid var(--pp-border);border-radius:8px;font-size:0.8rem;background:var(--pp-input-bg);font-family:inherit;color:var(--pp-text);min-height:60px;resize:vertical}
.hosted-by-label{position:relative;display:inline-flex;align-items:center;gap:4px}
.hosted-by-info{display:inline-flex;align-items:center;justify-content:center;width:14px;height:14px;border-radius:50%;background:var(--pp-blue);color:#fff;font-size:0.55rem;font-weight:700;cursor:help;flex-shrink:0}
.quick-stats{background:var(--pp-navy);padding:10px 24px;display:flex;gap:20px;flex-wrap:wrap;justify-content:space-between;align-items:center}
.quick-stats-left{display:flex;gap:20px;flex-wrap:wrap}
.quick-stat{display:flex;align-items:center;gap:8px;color:#fff;padding:6px 10px;border-radius:8px}
.quick-stat-icon{width:32px;height:32px;background:rgba(255,255,255,0.1);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1rem}
.quick-stat-value{font-size:1.1rem;font-weight:700}
.quick-stat-label{font-size:0.6rem;opacity:0.8;text-transform:uppercase}
.quick-stats-right{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.key-filter{display:flex;align-items:center;gap:8px}
.key-filter label{color:#fff;font-size:0.75rem;font-weight:600}
.toggle-switch{position:relative;width:44px;height:24px}
.toggle-switch input{opacity:0;width:0;height:0}
.toggle-slider{position:absolute;cursor:pointer;inset:0;background:rgba(255,255,255,0.2);border-radius:24px;transition:0.3s}
.toggle-slider:before{content:'';position:absolute;height:18px;width:18px;left:3px;bottom:3px;background:#fff;border-radius:50%;transition:0.3s}
.toggle-switch input:checked+.toggle-slider{background:var(--pp-light-blue)}
.toggle-switch input:checked+.toggle-slider:before{transform:translateX(20px)}
.btn-reset-bar{background:rgba(255,255,255,0.15);color:#fff;border:1px solid rgba(255,255,255,0.3);padding:6px 14px;border-radius:8px;cursor:pointer;font-weight:600;font-size:0.72rem;font-family:inherit;display:inline-flex;align-items:center;gap:5px;transition:all 0.25s}
.btn-reset-bar:hover{background:rgba(255,255,255,0.3);transform:translateY(-1px)}
.admin-panel{background:linear-gradient(135deg,#F1F5F9 0%,#E2E8F0 100%);border:2px solid var(--pp-navy);padding:16px;margin:16px;border-radius:var(--pp-radius);display:none}
.admin-panel.active{display:block}
.admin-panel h3{color:var(--pp-navy);margin-bottom:12px;font-size:1rem}
.admin-tabs{display:flex;gap:6px;margin-bottom:16px;flex-wrap:wrap}
.admin-tab{padding:8px 16px;background:#fff;border:2px solid var(--pp-navy);border-radius:8px;cursor:pointer;font-weight:600;font-size:0.8rem;color:var(--pp-navy);transition:all 0.3s}
.admin-tab:hover{background:var(--pp-gray-100)}
.admin-tab.active{background:var(--pp-navy);color:#fff}
.admin-section{display:none}.admin-section.active{display:block}
.admin-form{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px}
.admin-buttons{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
.settings-list{background:#fff;border-radius:8px;padding:12px;margin-bottom:12px;max-height:250px;overflow-y:auto}
.settings-item{display:flex;align-items:center;gap:10px;padding:8px;border-bottom:1px solid #E2E8F0}
.settings-item:last-child{border-bottom:none}
.settings-item-color{width:20px;height:20px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:0.7rem}
.settings-item-info{flex:1}
.settings-item-name{font-weight:700;font-size:0.85rem;color:var(--pp-black)}
.settings-item-id{font-size:0.65rem;color:#64748B}
.add-new-form{background:#fff;border-radius:8px;padding:12px;display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px;align-items:end}
.add-new-form input,.add-new-form select{padding:8px;border:2px solid #E2E8F0;border-radius:6px;font-size:0.8rem;color:var(--pp-black);background:#fff}
.color-picker{display:flex;gap:4px;flex-wrap:wrap}
.color-option{width:24px;height:24px;border-radius:4px;cursor:pointer;border:2px solid transparent;transition:transform 0.2s}
.color-option:hover{transform:scale(1.1)}
.color-option.selected{border-color:var(--pp-black);transform:scale(1.1)}
.calendar-view,.dashboard-view,.timeline-view{display:none;animation:viewFadeIn 0.5s}
.calendar-view.active,.dashboard-view.active,.timeline-view.active{display:block}
@keyframes viewFadeIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}
.calendar{padding:20px}
.month-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(380px,1fr));gap:16px}
.month-card{background:var(--pp-card-bg);border-radius:var(--pp-radius);border:1px solid var(--pp-border);overflow:hidden;box-shadow:var(--pp-shadow);transition:all 0.35s}
.month-card:hover{box-shadow:0 8px 25px rgba(0,0,0,0.1);transform:translateY(-3px)}
.month-card.current-month{border:3px solid var(--pp-blue)}
.month-card.collapsed .events-list{display:none}
.month-header{background:var(--pp-gradient);color:#fff;padding:14px 16px;display:flex;justify-content:space-between;align-items:center;cursor:pointer;width:100%;border:none;text-align:left;font-family:inherit}
.month-name{font-size:1.1rem;font-weight:700;display:flex;align-items:center;gap:8px}
.month-badge{background:rgba(255,255,255,0.2);padding:4px 10px;border-radius:20px;font-size:0.7rem;font-weight:700}
.collapse-icon{transition:transform 0.3s;font-size:0.8rem}
.month-card.collapsed .collapse-icon{transform:rotate(-90deg)}
.current-month-badge{background:#00CF92;padding:3px 10px;border-radius:20px;font-size:0.65rem;font-weight:700}
.month-moment{background:linear-gradient(135deg,#EFF6FF 0%,#DBEAFE 100%);padding:10px 16px;border-bottom:1px solid #BFDBFE;font-size:0.75rem;color:var(--pp-navy);font-weight:600}
[data-theme="dark"] .month-moment{background:linear-gradient(135deg,#1E3A5F 0%,#1E3A8A 100%);border-color:#1E40AF;color:#93C5FD}
.events-list{padding:10px;max-height:450px;overflow-y:auto}
.event{background:var(--pp-gray-50);border-radius:8px;margin-bottom:6px;border-left:4px solid var(--pp-gray-300);cursor:pointer;transition:all 0.3s;overflow:hidden}
.event:hover{box-shadow:0 4px 15px rgba(0,0,0,0.08);transform:translateX(4px);border-left-color:var(--pp-blue)}
.event.key{border-left:5px solid #00CF92;background:linear-gradient(135deg,#ECFDF5 0%,#D1FAE5 100%)}
.event.key::before{content:'â­ KEY EVENT';display:block;background:linear-gradient(90deg,#003087,#0070BA);color:#fff;font-size:0.6rem;font-weight:700;padding:2px 12px}
[data-theme="dark"] .event.key{background:linear-gradient(135deg,#064E3B 0%,#065F46 100%)}
.event.past-event{opacity:0.5}
.event-header{padding:10px 12px;display:flex;align-items:flex-start;gap:8px}
.event-icon{font-size:1rem}
.event-content{flex:1;min-width:0}
.event-title{font-weight:700;color:var(--pp-text);font-size:0.8rem;line-height:1.3;margin-bottom:4px}
.event-meta{display:flex;flex-wrap:wrap;gap:3px}
.event-host-tag{display:inline-flex;align-items:center;gap:3px;padding:2px 6px;border-radius:4px;font-size:0.6rem;font-weight:700;border-left:3px solid}
.event-actions{display:none;gap:3px;margin-left:auto}
.admin-mode .event-actions{display:flex}
.event-actions button{padding:3px 6px;border-radius:4px;border:none;cursor:pointer;font-size:0.6rem;font-weight:600}
.event-cta{display:flex;gap:4px;margin-top:6px}
.event-cta-btn{padding:4px 8px;border-radius:4px;font-size:0.65rem;font-weight:600;border:none;cursor:pointer;transition:all 0.2s;display:inline-flex;align-items:center;justify-content:center;text-decoration:none}
.event-cta-btn.primary{background:var(--pp-navy);color:#fff}
.event-cta-btn.secondary{background:var(--pp-gray-200);color:var(--pp-text)}
.tag{padding:2px 6px;border-radius:4px;font-size:0.6rem;font-weight:700}
.tag-date{background:var(--pp-navy);color:#fff}
.tag-key{background:#D1FAE5;color:#065F46}
.tag-country{background:var(--pp-gray-100);color:var(--pp-text)}
.tag-link{background:var(--pp-blue);color:#fff}
.no-events{text-align:center;padding:30px;color:var(--pp-text-muted)}
.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,48,135,0.5);display:none;align-items:center;justify-content:center;z-index:2000;padding:20px;backdrop-filter:blur(6px);opacity:0;transition:opacity 0.3s}
.modal-overlay.active{display:flex;opacity:1}
.modal{background:var(--pp-modal-bg);border-radius:var(--pp-radius);max-width:600px;width:100%;max-height:90vh;overflow:hidden;transform:scale(0.9);transition:transform 0.3s}
.modal-overlay.active .modal{transform:scale(1)}
.modal-header{background:var(--pp-gradient);color:#fff;padding:16px 20px;display:flex;justify-content:space-between;align-items:flex-start}
.modal-title{font-size:1.1rem;font-weight:700;margin-bottom:4px}
.modal-subtitle{font-size:0.8rem;opacity:0.9}
.modal-close{background:rgba(255,255,255,0.2);border:none;color:#fff;width:32px;height:32px;border-radius:8px;cursor:pointer;font-size:1.1rem;transition:all 0.3s;display:flex;align-items:center;justify-content:center}
.modal-close:hover{background:rgba(255,255,255,0.4);transform:rotate(90deg)}
.modal-body{padding:20px;max-height:55vh;overflow-y:auto}
.modal-section{margin-bottom:16px}
.modal-section-title{font-size:0.65rem;font-weight:700;color:var(--pp-text-muted);text-transform:uppercase;margin-bottom:6px}
.modal-description{font-size:0.9rem;padding:14px;background:var(--pp-gray-50);border-radius:8px;border-left:4px solid var(--pp-blue);color:var(--pp-text)}
.modal-details{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.modal-detail{display:flex;align-items:flex-start;gap:8px;padding:10px;background:var(--pp-gray-50);border-radius:8px}
.modal-detail-icon{font-size:1.1rem}
.modal-detail-label{font-size:0.65rem;color:var(--pp-text-muted);font-weight:600;text-transform:uppercase}
.modal-detail-value{font-size:0.85rem;font-weight:600;color:var(--pp-text)}
.modal-detail-value a{color:var(--pp-blue);text-decoration:none}
.modal-tags{display:flex;flex-wrap:wrap;gap:5px}
.modal-footer{padding:14px 20px;background:var(--pp-gray-50);border-top:1px solid var(--pp-border);display:flex;gap:8px;flex-wrap:wrap}
.modal-footer .btn{flex:1;justify-content:center;min-width:100px}
.event-link-box{background:var(--pp-navy);color:#fff;padding:12px;border-radius:8px;margin-top:12px;display:flex;align-items:center;gap:10px}
.event-link-box a{color:#fff;text-decoration:none;font-weight:600;word-break:break-all}
.footer{background:var(--pp-navy);padding:14px 24px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}
.footer-left{color:#fff;font-size:0.7rem;opacity:0.9}
.footer-update{color:rgba(255,255,255,0.7);font-size:0.65rem;margin-top:4px}
.footer-stats{display:flex;gap:10px}
.footer-stat{text-align:center;background:rgba(255,255,255,0.1);padding:6px 14px;border-radius:8px}
.footer-stat-value{font-size:1rem;font-weight:700;color:#fff}
.footer-stat-label{font-size:0.55rem;color:rgba(255,255,255,0.7);text-transform:uppercase}
.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--pp-navy);color:#fff;padding:14px 24px;border-radius:var(--pp-radius);font-weight:600;font-size:0.85rem;z-index:3000;transition:all 0.5s;display:flex;align-items:center;gap:10px}
.toast.active{transform:translateX(-50%) translateY(0)}
.bulk-info{background:#EFF6FF;border:2px solid var(--pp-blue);border-radius:8px;padding:14px;margin-bottom:14px}
.bulk-info h4{color:var(--pp-navy);margin-bottom:8px;font-size:0.9rem}
.bulk-info p{font-size:0.8rem;color:var(--pp-navy);margin-bottom:10px}
.updater-section{background:#fff;border-radius:8px;padding:12px;margin-top:12px}
.updater-section label{font-weight:600;color:var(--pp-navy);font-size:0.8rem;display:block;margin-bottom:6px}
.updater-section input{width:100%;padding:8px;border:2px solid #E2E8F0;border-radius:6px;font-size:0.8rem}
.dashboard-container{padding:20px;max-width:1400px;margin:0 auto}
.dashboard-grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
.dash-card{background:var(--pp-card-bg);border:1px solid var(--pp-border);border-radius:var(--pp-radius);padding:20px;box-shadow:var(--pp-shadow)}
.dash-card h4{font-size:0.9rem;color:var(--pp-text);margin-bottom:16px;display:flex;align-items:center;gap:8px}
.dash-card.span-3{grid-column:span 3}.dash-card.span-4{grid-column:span 4}.dash-card.span-6{grid-column:span 6}.dash-card.span-12{grid-column:span 12}
.stat-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.stat-box{background:var(--pp-gray-50);padding:16px;border-radius:8px;text-align:center}
.stat-box .value{font-size:2rem;font-weight:700;line-height:1}
.stat-box .label{font-size:0.7rem;color:var(--pp-text-muted);text-transform:uppercase;margin-top:4px}
.progress-item{margin-bottom:14px}
.progress-header{display:flex;align-items:center;gap:8px;margin-bottom:6px}
.progress-header .icon{font-size:1rem}
.progress-header .name{flex:1;font-size:0.85rem;font-weight:600;color:var(--pp-text)}
.progress-header .count{font-weight:700;color:var(--pp-text)}
.progress-header .pct{font-size:0.7rem;color:var(--pp-text-muted);margin-left:4px}
.progress-bar{background:var(--pp-gray-100);border-radius:4px;height:8px;overflow:hidden}
.progress-fill{height:100%;border-radius:4px;transition:width 0.8s}
.format-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.format-box{background:var(--pp-gray-50);padding:16px;border-radius:8px;text-align:center;border-left:4px solid}
.format-box .icon{font-size:1.5rem;margin-bottom:4px}
.format-box .value{font-size:1.5rem;font-weight:700;color:var(--pp-text)}
.format-box .label{font-size:0.7rem;color:var(--pp-text-muted);text-transform:capitalize}
.host-item{display:flex;align-items:center;gap:10px;padding:10px;background:var(--pp-gray-50);border-radius:6px;margin-bottom:8px}
.host-item .dot{width:12px;height:12px;border-radius:3px}
.host-item .name{flex:1;font-size:0.85rem;color:var(--pp-text)}
.host-item .count{font-weight:700;color:var(--pp-text)}
.host-item .pct{font-size:0.7rem;color:var(--pp-text-muted)}
.country-item{display:flex;align-items:center;gap:10px;margin-bottom:10px;padding:6px;border-radius:6px}
.country-item .flag{font-size:1.2rem}
.country-item .name{flex:1;font-size:0.85rem;color:var(--pp-text)}
.country-item .badge{background:var(--pp-blue);color:#fff;padding:2px 10px;border-radius:12px;font-size:0.75rem;font-weight:700}
.month-chart{display:flex;align-items:flex-end;gap:6px;height:140px;padding-top:20px}
.month-bar{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px}
.month-bar .bar{width:100%;border-radius:4px 4px 0 0;transition:all 0.5s;min-height:4px}
.month-bar .label{font-size:0.6rem;color:var(--pp-text-muted)}
.month-bar .count{font-size:0.7rem;font-weight:700;color:var(--pp-text)}
.timeline-month-header{background:var(--pp-gradient);color:#fff;padding:20px 24px;margin:24px 0 16px 0;border-radius:var(--pp-radius);font-size:1.5rem;font-weight:700;display:flex;align-items:center;justify-content:space-between;box-shadow:0 4px 20px rgba(0,48,135,0.25)}
.timeline-month-header:first-child{margin-top:0}
.timeline-month-header .month-count{background:rgba(255,255,255,0.2);padding:6px 16px;border-radius:20px;font-size:0.9rem}
.timeline-event{background:var(--pp-card-bg);border:1px solid var(--pp-border);border-left:4px solid var(--pp-gray-300);border-radius:8px;padding:14px;margin-bottom:10px;cursor:pointer;transition:all 0.2s}
.timeline-event:hover{box-shadow:0 4px 15px rgba(0,0,0,0.08);transform:translateX(4px);border-left-color:var(--pp-blue)}
.timeline-event.key{border-left-color:#00CF92;background:linear-gradient(135deg,#ECFDF5 0%,#D1FAE5 100%)}
.timeline-event-header{display:flex;align-items:flex-start;gap:12px}
.timeline-event-icon{font-size:1.3rem}
.timeline-event-content{flex:1}
.timeline-event-title{font-weight:700;color:var(--pp-text);margin-bottom:4px;font-size:0.95rem}
.timeline-event-meta{display:flex;flex-wrap:wrap;gap:6px;font-size:0.75rem}
.timeline-event-time{font-size:0.75rem;color:var(--pp-text-muted);margin-top:6px}
.timeline-event-host{font-size:0.75rem;margin-top:6px;padding:4px 10px;background:var(--pp-gray-50);border-radius:6px;display:inline-flex;align-items:center;gap:6px;border-left:3px solid var(--pp-gray-300)}
.timeline-event-host .host-dot{width:8px;height:8px;border-radius:2px}
.timeline-event-actions{display:none;gap:4px;margin-top:8px}
.admin-mode .timeline-event-actions{display:flex}
.timeline-event-actions button{padding:4px 8px;border-radius:4px;border:none;cursor:pointer;font-size:0.65rem;font-weight:600}
.sr-only{position:absolute!important;width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}
.skip-link{position:absolute;left:16px;top:12px;background:#fff;color:var(--pp-navy);padding:8px 12px;border-radius:10px;z-index:4000;transform:translateY(-200%);transition:transform .2s}
.skip-link:focus{transform:translateY(0)}
:focus-visible{outline:3px solid var(--pp-light-blue);outline-offset:2px}
@media(prefers-reduced-motion:reduce){*{scroll-behavior:auto!important;transition:none!important;animation:none!important}}
@media(max-width:1200px){.dash-card.span-3,.dash-card.span-4{grid-column:span 6}}
@media(max-width:768px){.filters-row{grid-template-columns:1fr 1fr}.month-grid{grid-template-columns:1fr}.modal-details{grid-template-columns:1fr}.dash-card.span-3,.dash-card.span-4,.dash-card.span-6{grid-column:span 12}.stat-grid{grid-template-columns:repeat(2,1fr)}.format-grid{grid-template-columns:1fr}.timeline-month-header{font-size:1.2rem;padding:16px 20px}}
</style>
</head>
<body>
<a class="skip-link" href="#filters">Skip to filters</a>
<div class="container">
<header class="header">
<div class="header-top">
<div class="header-left">
<div class="logo" title="PayPal"><svg viewBox="0 0 124 33" height="28"><path fill="#fff" d="M46.211 6.749h-6.839a.95.95 0 0 0-.939.802l-2.766 17.537a.57.57 0 0 0 .564.658h3.265a.95.95 0 0 0 .939-.803l.746-4.73a.95.95 0 0 1 .938-.803h2.165c4.505 0 7.105-2.18 7.784-6.5.306-1.89.013-3.375-.872-4.415-.972-1.142-2.696-1.746-4.985-1.746zM47 13.154c-.374 2.454-2.249 2.454-4.062 2.454h-1.032l.724-4.583a.57.57 0 0 1 .563-.481h.473c1.235 0 2.4 0 3.002.704.359.42.469 1.044.332 1.906zM66.654 13.075h-3.275a.57.57 0 0 0-.563.481l-.145.916-.229-.332c-.709-1.029-2.29-1.373-3.868-1.373-3.619 0-6.71 2.741-7.312 6.586-.313 1.918.132 3.752 1.22 5.031.998 1.176 2.426 1.666 4.125 1.666 2.916 0 4.533-1.875 4.533-1.875l-.146.91a.57.57 0 0 0 .562.66h2.95a.95.95 0 0 0 .939-.803l1.77-11.209a.568.568 0 0 0-.561-.658zm-4.565 6.374c-.316 1.871-1.801 3.127-3.695 3.127-.951 0-1.711-.305-2.199-.883-.484-.574-.668-1.391-.514-2.301.295-1.855 1.805-3.152 3.67-3.152.93 0 1.686.309 2.184.892.499.589.697 1.411.554 2.317zM84.096 13.075h-3.291a.954.954 0 0 0-.787.417l-4.539 6.686-1.924-6.425a.953.953 0 0 0-.912-.678h-3.234a.57.57 0 0 0-.541.754l3.625 10.638-3.408 4.811a.57.57 0 0 0 .465.9h3.287a.949.949 0 0 0 .781-.408l10.946-15.8a.57.57 0 0 0-.468-.895z"/><path fill="#fff" d="M94.992 6.749h-6.84a.95.95 0 0 0-.938.802l-2.766 17.537a.569.569 0 0 0 .562.658h3.51a.665.665 0 0 0 .656-.562l.785-4.971a.95.95 0 0 1 .938-.803h2.164c4.506 0 7.105-2.18 7.785-6.5.307-1.89.012-3.375-.873-4.415-.971-1.142-2.694-1.746-4.983-1.746zm.789 6.405c-.373 2.454-2.248 2.454-4.062 2.454h-1.031l.725-4.583a.568.568 0 0 1 .562-.481h.473c1.234 0 2.4 0 3.002.704.359.42.468 1.044.331 1.906zM115.434 13.075h-3.273a.567.567 0 0 0-.562.481l-.145.916-.23-.332c-.709-1.029-2.289-1.373-3.867-1.373-3.619 0-6.709 2.741-7.311 6.586-.312 1.918.131 3.752 1.219 5.031 1 1.176 2.426 1.666 4.125 1.666 2.916 0 4.533-1.875 4.533-1.875l-.146.91a.57.57 0 0 0 .564.66h2.949a.95.95 0 0 0 .938-.803l1.771-11.209a.571.571 0 0 0-.565-.658zm-4.565 6.374c-.314 1.871-1.801 3.127-3.695 3.127-.949 0-1.711-.305-2.199-.883-.484-.574-.666-1.391-.514-2.301.297-1.855 1.805-3.152 3.67-3.152.93 0 1.686.309 2.184.892.501.589.699 1.411.554 2.317zM119.295 7.23l-2.807 17.858a.569.569 0 0 0 .562.658h2.822a.949.949 0 0 0 .939-.803l2.768-17.536a.57.57 0 0 0-.562-.659h-3.16a.571.571 0 0 0-.562.482z"/><path fill="#009CDE" d="M7.266 29.154l.523-3.322-1.165-.027H1.061L4.927 1.292a.316.316 0 0 1 .314-.268h9.38c3.114 0 5.263.648 6.385 1.927.526.6.861 1.227 1.023 1.917.17.724.173 1.589.007 2.644l-.012.077v.676l.526.298a3.69 3.69 0 0 1 1.065.812c.45.513.741 1.165.864 1.938.127.795.085 1.741-.123 2.812-.24 1.232-.628 2.305-1.152 3.183a6.547 6.547 0 0 1-1.825 2c-.696.494-1.523.869-2.458 1.109-.906.236-1.939.355-3.072.355h-.73c-.522 0-1.029.188-1.427.525a2.21 2.21 0 0 0-.744 1.328l-.055.299-.924 5.855-.042.215c-.011.068-.03.102-.058.125a.155.155 0 0 1-.096.035H7.266z"/><path fill="#0070BA" d="M23.048 7.667c-.028.179-.06.362-.096.55-1.237 6.351-5.469 8.545-10.874 8.545H9.326c-.661 0-1.218.48-1.321 1.132L6.596 26.83l-.399 2.533a.704.704 0 0 0 .695.814h4.881c.578 0 1.069-.42 1.16-.99l.048-.248.919-5.832.059-.32c.09-.572.582-.992 1.16-.992h.73c4.729 0 8.431-1.92 9.513-7.476.452-2.321.218-4.259-.978-5.622a4.667 4.667 0 0 0-1.336-1.03z"/><path fill="#003087" d="M21.754 7.151a9.757 9.757 0 0 0-1.203-.267 15.284 15.284 0 0 0-2.426-.177h-7.352a1.172 1.172 0 0 0-1.159.992L8.05 17.605l-.045.289a1.336 1.336 0 0 1 1.321-1.132h2.752c5.405 0 9.637-2.195 10.874-8.545.037-.188.068-.371.096-.55a6.594 6.594 0 0 0-1.017-.429 9.045 9.045 0 0 0-.277-.087z"/><path fill="#003087" d="M9.614 7.699a1.169 1.169 0 0 1 1.159-.991h7.352c.871 0 1.684.057 2.426.177a9.757 9.757 0 0 1 1.481.353c.365.121.704.264 1.017.429.368-2.347-.003-3.945-1.272-5.392C20.378.682 17.853 0 14.622 0h-9.38c-.66 0-1.223.48-1.325 1.133L.01 25.898a.806.806 0 0 0 .795.932h5.791l1.454-9.225 1.564-9.906z"/></svg></div>
<div class="header-title"><h1>Global Benefits Calendar 2026</h1><p>Helping You Thrive â€” At Work and in Life</p></div>
</div>
<div class="header-right">
<div class="search-box" title="Search events by name or description"><span aria-hidden="true">ğŸ”</span><label class="sr-only" for="searchInput">Search events</label><input type="text" id="searchInput" placeholder="Search events..." aria-label="Search events"></div>
<div class="view-toggle" title="Switch between calendar, timeline, and dashboard views">
<button class="view-btn active" data-view="calendar" aria-label="Calendar view" title="Calendar view â€“ events grouped by month in cards">ğŸ“…</button>
<button class="view-btn" data-view="timeline" aria-label="Timeline view" title="Timeline view â€“ events in a single scrollable list">ğŸ“‹</button>
<button class="view-btn" data-view="dashboard" aria-label="Dashboard view" title="Dashboard view â€“ charts and statistics overview">ğŸ“Š</button>
</div>
<button class="btn btn-white" onclick="exportCSV()" title="Export filtered events as a CSV file">ğŸ“¤ Export</button>
<button class="btn btn-glass" onclick="toggleTheme()" id="themeBtn" aria-label="Toggle dark/light theme" title="Toggle dark/light theme">ğŸŒ™</button>
<button class="btn btn-admin" id="adminBtn" onclick="toggleAdminMode()" title="Toggle admin mode to add, edit or delete events">âš™ï¸ Admin</button>
</div>
</div>
</header>
<div class="admin-panel" id="adminPanel">
<h3>âš™ï¸ Admin Panel</h3>
<div class="admin-tabs">
<div class="admin-tab active" onclick="switchAdminTab('events')" title="Add or edit calendar events">ğŸ“… Events</div>
<div class="admin-tab" onclick="switchAdminTab('hosts')" title="Manage host organisations">ğŸ¢ Hosts</div>
<div class="admin-tab" onclick="switchAdminTab('countries')" title="Manage available countries">ğŸŒ Countries</div>
<div class="admin-tab" onclick="switchAdminTab('regions')" title="Manage regions">ğŸ—ºï¸ Regions</div>
<div class="admin-tab" onclick="switchAdminTab('pillars')" title="Manage wellbeing pillars">ğŸ¯ Pillars</div>
<div class="admin-tab" onclick="switchAdminTab('bulk')" title="Upload multiple events via CSV">ğŸ“Š Bulk Upload</div>
<div class="admin-tab" onclick="switchAdminTab('data')" title="Export, import, or reset all data">ğŸ’¾ Data</div>
</div>
<div class="admin-section active" id="admin-events">
<div class="admin-form">
<div class="filter-group"><label>Name *</label><input type="text" id="adminName"></div>
<div class="filter-group"><label>Month *</label><select id="adminMonth"></select></div>
<div class="filter-group"><label>Day *</label><input type="number" id="adminDay" min="1" max="31"></div>
<div class="filter-group"><label>Date Display</label><input type="text" id="adminDate" placeholder="e.g. 17-19th"></div>
<div class="filter-group"><label>Pillar *</label><select id="adminPillar"></select></div>
<div class="filter-group"><label>Hosted By *</label><select id="adminSource"></select></div>
<div class="filter-group"><label>Format</label><select id="adminFormat"><option value="virtual">ğŸ’» Virtual</option><option value="onsite">ğŸ¢ Onsite</option><option value="hybrid">ğŸ”„ Hybrid</option></select></div>
<div class="filter-group"><label>Icon</label><input type="text" id="adminIcon" placeholder="ğŸ’ª"></div>
<div class="filter-group"><label>Time</label><input type="text" id="adminTime"></div>
<div class="filter-group"><label>Location</label><input type="text" id="adminRoom"></div>
<div class="filter-group"><label>Contact</label><input type="text" id="adminContact"></div>
<div class="filter-group"><label>Email</label><input type="email" id="adminEmail"></div>
<div class="filter-group"><label>Event Link</label><input type="url" id="adminLink"></div>
<div class="filter-group"><label>Key Event?</label><select id="adminKey"><option value="false">No</option><option value="true">â­ Yes</option></select></div>
<div class="filter-group" style="grid-column:span 2"><label>Description</label><textarea id="adminDesc"></textarea></div>
<div class="filter-group"><label>Countries</label><select id="adminCountries" multiple style="min-height:100px"></select></div>
</div>
<div class="admin-buttons">
<button class="btn btn-success" onclick="saveEvent()" title="Save this event to the calendar">ğŸ’¾ Save Event</button>
<button class="btn btn-secondary" onclick="clearAdminForm()" title="Clear the form fields">ğŸ—‘ï¸ Clear</button>
<input type="hidden" id="editingEventId" value="">
</div>
</div>
<div class="admin-section" id="admin-hosts"><div class="settings-list" id="hostsList"></div><div class="add-new-form"><input type="text" id="newSourceId" placeholder="ID"><input type="text" id="newSourceName" placeholder="Name"><input type="text" id="newSourceDesc" placeholder="Description"><div class="filter-group"><label>Color</label><div class="color-picker" id="sourceColorPicker"></div></div><button class="btn btn-success" onclick="addSource()">â• Add</button></div></div>
<div class="admin-section" id="admin-countries"><div class="settings-list" id="countriesList"></div><div class="add-new-form"><input type="text" id="newCountryId" placeholder="ID"><input type="text" id="newCountryName" placeholder="Name"><input type="text" id="newCountryFlag" placeholder="Flag ğŸ‡¦ğŸ‡¹"><select id="newCountryRegion"></select><button class="btn btn-success" onclick="addCountry()">â• Add</button></div></div>
<div class="admin-section" id="admin-regions"><div class="settings-list" id="regionsList"></div><div class="add-new-form"><input type="text" id="newRegionId" placeholder="ID"><input type="text" id="newRegionName" placeholder="Name"><button class="btn btn-success" onclick="addRegion()">â• Add</button></div></div>
<div class="admin-section" id="admin-pillars"><div class="settings-list" id="pillarsList"></div><div class="add-new-form"><input type="text" id="newPillarId" placeholder="ID"><input type="text" id="newPillarName" placeholder="Name"><input type="text" id="newPillarIcon" placeholder="Icon ğŸ¤"><div class="filter-group"><label>Color</label><div class="color-picker" id="pillarColorPicker"></div></div><button class="btn btn-success" onclick="addPillar()">â• Add</button></div></div>
<div class="admin-section" id="admin-bulk"><div class="bulk-info"><h4>ğŸ“Š Bulk Upload</h4><p>Download template, fill in, save as CSV, upload.</p></div><div class="admin-buttons"><button class="btn btn-primary" onclick="downloadTemplate()">ğŸ“¥ Template</button><button class="btn btn-success" onclick="document.getElementById('bulkFile').click()">ğŸ“¤ Upload</button><input type="file" id="bulkFile" accept=".csv" style="display:none" onchange="bulkUpload(event)"></div></div>
<div class="admin-section" id="admin-data"><div class="updater-section"><label>ğŸ‘¤ Your Name</label><input type="text" id="updaterName" placeholder="Enter your name" onchange="saveUpdaterName()"></div><div class="admin-buttons" style="margin-top:12px"><button class="btn btn-primary" onclick="exportAllData()">ğŸ“¥ Export JSON</button><button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">ğŸ“¤ Import</button><input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)"><button class="btn btn-danger" onclick="resetToDefault()">ğŸ”„ Reset</button></div></div>
</div>
<div class="filters" id="filters">
<div class="filters-row">
<div class="filter-group"><label for="regionFilter" title="Filter events by geographic region">ğŸ—ºï¸ Region</label><select id="regionFilter" title="Select a region to filter events"></select></div>
<div class="filter-group"><label for="countryFilter" title="Filter events by specific country">ğŸŒ Country</label><select id="countryFilter" title="Select a country to see its events"></select></div>
<div class="filter-group"><label for="sourceFilter" class="hosted-by-label" title="The organisation or team running the event (e.g. Vhi, RSM, ERG, Benefits Team)">ğŸ¢ Hosted By <span class="hosted-by-info" title="'Hosted By' is the organisation or team responsible for delivering this event, e.g. Vhi Bespoke, RSM, Optum, ERGs, Sites, Nudge, or the Benefits Team">?</span></label><select id="sourceFilter" title="Filter by the host organisation running the event"></select></div>
<div class="filter-group"><label for="monthFilter" title="Filter events by calendar month">ğŸ“… Month</label><select id="monthFilter" title="Select a month to view its events"></select></div>
<div class="filter-group"><label for="pillarFilter" title="Filter by wellbeing pillar: Physical, Financial, or Emotional">ğŸ¯ Pillar</label><select id="pillarFilter" title="Select a wellbeing pillar to filter events"></select></div>
<div class="filter-group"><label for="formatFilter" title="Filter by event delivery format">ğŸ“ Format</label><select id="formatFilter" title="Select Virtual, Onsite, or Hybrid"><option value="all">All Formats</option><option value="virtual">ğŸ’» Virtual</option><option value="onsite">ğŸ¢ Onsite</option><option value="hybrid">ğŸ”„ Hybrid</option></select></div>
</div>
</div>
<div class="quick-stats" id="quickStats"></div>
<div class="calendar-view active"><div class="calendar"><div class="month-grid" id="calendarGrid"></div></div></div>
<div class="timeline-view"><div id="timelineContainer" style="padding:20px;max-width:900px;margin:0 auto"></div></div>
<div class="dashboard-view"><div class="dashboard-container"><div class="dashboard-grid" id="dashboardGrid"></div></div></div>
<footer class="footer">
<div class="footer-left"><div><strong>PayPal Global Benefits Team</strong></div><div class="footer-update" id="footerUpdate">Updated: January 2026</div></div>
<div class="footer-stats" id="footerStats"></div>
</footer>
</div>
<div class="modal-overlay" id="eventModal" aria-hidden="true">
<div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDescription" tabindex="-1">
<div class="modal-header"><div><div class="modal-title" id="modalTitle"></div><div class="modal-subtitle" id="modalSubtitle"></div></div><button class="modal-close" onclick="closeModal()" title="Close this dialog">âœ•</button></div>
<div class="modal-body">
<div class="modal-section"><div class="modal-section-title">Description</div><div class="modal-description" id="modalDescription"></div></div>
<div class="modal-section"><div class="modal-section-title">Details</div><div class="modal-details" id="modalDetails"></div></div>
<div id="modalLinkSection"></div>
<div class="modal-section"><div class="modal-section-title">Tags</div><div class="modal-tags" id="modalTags"></div></div>
</div>
<div class="modal-footer">
<button class="btn btn-primary" onclick="addToOutlook()" title="Add this event to your Outlook calendar">ğŸ“… Outlook</button>
<button class="btn btn-secondary" onclick="addToGoogle()" title="Add this event to your Google calendar">ğŸ“… Google</button>
<button class="btn btn-secondary" onclick="closeModal()">Close</button>
</div>
</div>
</div>
<div class="toast" id="toast" role="status" aria-live="polite" aria-atomic="true"></div>
<script>
const SK='pp_cal_v10',MN=["January","February","March","April","May","June","July","August","September","October","November","December"],DC=['#003087','#0070BA','#009CDE','#22C55E','#06B6D4','#3B82F6','#8B5CF6','#EC4899','#14B8A6','#6366F1'];
let dm=false,am=false,ce=null,eid=200,ssc='#0070BA',spc='#8B5CF6',lu=null,un='',kof=false;
let cfg={regions:{emea:{name:"EMEA"},amer:{name:"AMER"},latam:{name:"LATAM/CAN"},apac:{name:"APAC"}},sources:{vhibespoke:{name:"Vhi Bespoke",color:"#0070BA",desc:"Premium wellness services tailored for employees"},vhicommunity:{name:"Vhi Community",color:"#009CDE",desc:"Community wellness events open to all"},rsm:{name:"RSM",color:"#8B5CF6",desc:"Pension and financial guidance provider"},optum:{name:"Optum",color:"#06B6D4",desc:"Health and wellbeing support services"},erg:{name:"ERG",color:"#003087",desc:"Employee Resource Groups â€“ employee-led communities"},sites:{name:"Sites",color:"#22C55E",desc:"Local office-based events and activities"},nudge:{name:"Nudge",color:"#EC4899",desc:"Financial wellbeing education platform"},benefits:{name:"Benefits Team",color:"#14B8A6",desc:"PayPal Global Benefits team initiatives"}},countries:{ireland:{name:"Ireland",flag:"ğŸ‡®ğŸ‡ª",region:"emea"},belgium:{name:"Belgium",flag:"ğŸ‡§ğŸ‡ª",region:"emea"},france:{name:"France",flag:"ğŸ‡«ğŸ‡·",region:"emea"},germany:{name:"Germany",flag:"ğŸ‡©ğŸ‡ª",region:"emea"},israel:{name:"Israel",flag:"ğŸ‡®ğŸ‡±",region:"emea"},italy:{name:"Italy",flag:"ğŸ‡®ğŸ‡¹",region:"emea"},luxembourg:{name:"Luxembourg",flag:"ğŸ‡±ğŸ‡º",region:"emea"},netherlands:{name:"Netherlands",flag:"ğŸ‡³ğŸ‡±",region:"emea"},poland:{name:"Poland",flag:"ğŸ‡µğŸ‡±",region:"emea"},russia:{name:"Russia",flag:"ğŸ‡·ğŸ‡º",region:"emea"},spain:{name:"Spain",flag:"ğŸ‡ªğŸ‡¸",region:"emea"},sweden:{name:"Sweden",flag:"ğŸ‡¸ğŸ‡ª",region:"emea"},uk:{name:"United Kingdom",flag:"ğŸ‡¬ğŸ‡§",region:"emea"},usa:{name:"United States",flag:"ğŸ‡ºğŸ‡¸",region:"amer"},canada:{name:"Canada",flag:"ğŸ‡¨ğŸ‡¦",region:"latam"},brazil:{name:"Brazil",flag:"ğŸ‡§ğŸ‡·",region:"latam"},mexico:{name:"Mexico",flag:"ğŸ‡²ğŸ‡½",region:"latam"},argentina:{name:"Argentina",flag:"ğŸ‡¦ğŸ‡·",region:"latam"},australia:{name:"Australia",flag:"ğŸ‡¦ğŸ‡º",region:"apac"},singapore:{name:"Singapore",flag:"ğŸ‡¸ğŸ‡¬",region:"apac"},india:{name:"India",flag:"ğŸ‡®ğŸ‡³",region:"apac"},japan:{name:"Japan",flag:"ğŸ‡¯ğŸ‡µ",region:"apac"},hongkong:{name:"Hong Kong",flag:"ğŸ‡­ğŸ‡°",region:"apac"},china:{name:"China",flag:"ğŸ‡¨ğŸ‡³",region:"apac"}},pillars:{emotional:{name:"Emotional",icon:"ğŸ’œ",color:"#8B5CF6"},financial:{name:"Financial",icon:"ğŸ’š",color:"#22C55E"},physical:{name:"Physical",icon:"ğŸ’™",color:"#0070BA"}}};
let cd={January:{moment:"ğŸ† New Year / International Mentoring Day (17th)",events:[{id:1,n:"Remote Gym: 6 Weeks to a Fitter You",p:"physical",i:"ğŸ’ª",desc:"Join our 6-week fitness programme to kickstart your 2026 health journey with expert trainers.",src:"vhibespoke",countries:["ireland"],format:"virtual",time:"Tue & Thu, 12:00-12:45 GMT",contact:"Vhi Wellness Team",email:"wellness@vhi.ie",day:7,month:1},{id:2,n:"Financial Wellbeing: Taking Charge with askpaul",p:"financial",i:"ğŸ’°",desc:"Expert financial guidance with Paul Merriman covering budgeting, savings, and investment basics.",src:"vhibespoke",countries:["ireland"],key:true,format:"virtual",time:"13:00-14:00 GMT",contact:"Paul Merriman",email:"info@askpaul.ie",day:22,month:1,date:"22nd"},{id:3,n:"Your 2026 Game Plan: Success Starts Now",p:"emotional",i:"ğŸ¯",desc:"Goal-setting and motivation webinar for personal and professional development.",src:"vhicommunity",countries:["ireland"],format:"virtual",time:"11:00-12:00 GMT",day:16,month:1,date:"16th"},{id:4,n:"New Year Benefits Overview",p:"emotional",i:"ğŸ‰",desc:"Annual benefits overview highlighting key programmes, deadlines, and new offerings for 2026.",src:"benefits",countries:["all"],format:"virtual",day:1,month:1,date:"1st"},{id:5,n:"International Mentoring Day",p:"emotional",i:"ğŸ¤",desc:"Celebrate mentorship programmes with networking sessions and mentor-mentee matching.",src:"erg",countries:["all"],format:"hybrid",time:"10:00-16:00 local",day:17,month:1,date:"17th"}]},February:{moment:"âœŠ Black History Month / Lunar New Year (12th)",events:[{id:6,n:"Healthcheck @Work Screening",p:"physical",i:"ğŸ¥",desc:"Comprehensive onsite health screening: blood pressure, cholesterol, BMI, lifestyle assessment.",src:"vhibespoke",countries:["ireland"],key:true,format:"onsite",time:"09:00-17:00 GMT",room:"Dublin Office - Wellness Room",day:17,month:2,date:"17-19th"},{id:7,n:"Chair Massage",p:"physical",i:"ğŸ’†",desc:"15-minute relaxation massage sessions. Walk-ins welcome or book your slot.",src:"vhibespoke",countries:["ireland"],format:"onsite",time:"10:00-16:00 GMT",room:"Dublin Office - Quiet Room",day:10,month:2,date:"10th"},{id:8,n:"World Cancer Day Awareness",p:"physical",i:"ğŸ—ï¸",desc:"Cancer prevention and early detection awareness webinar with specialists.",src:"vhicommunity",countries:["ireland"],format:"virtual",time:"12:00-13:00 GMT",day:4,month:2,date:"4th"},{id:9,n:"Heart Health Awareness",p:"physical",i:"â¤ï¸",desc:"Cardiovascular health awareness and prevention strategies.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:14,month:2,date:"14th"},{id:10,n:"Black History Month Events",p:"emotional",i:"âœŠ",desc:"A month of events celebrating Black history, culture, and contributions.",src:"erg",countries:["all"],key:true,erg:"Amplify",format:"hybrid",day:1,month:2,date:"All Month"},{id:11,n:"Lunar New Year Celebration",p:"emotional",i:"ğŸ‰",desc:"Celebrate the Year of the Snake with cultural activities and traditional food.",src:"erg",countries:["all"],erg:"Rise",format:"hybrid",day:12,month:2,date:"12th"},{id:12,n:"RSM Pension Session Webinar",p:"financial",i:"ğŸ’¼",desc:"Expert pension guidance session covering retirement planning for UK employees.",src:"rsm",countries:["uk"],format:"virtual",time:"12:00-13:00 GMT",day:25,month:2,date:"25th"}]},March:{moment:"ğŸ’œ Women's History Month / IWD (8th) / Trans Day of Visibility (31st)",events:[{id:13,n:"IWD Keynote Speaker Event",p:"emotional",i:"ğŸ‘©â€ğŸ’¼",desc:"International Women's Day flagship event with inspiring keynote speaker and panel.",src:"vhibespoke",countries:["ireland"],key:true,format:"hybrid",time:"10:00-12:00 GMT",room:"Dublin Town Hall & Virtual",day:8,month:3,date:"8th"},{id:14,n:"6 Week Yoga Flow Programme",p:"physical",i:"ğŸ§˜",desc:"Weekly yoga sessions for all levels, focusing on flexibility and mindfulness.",src:"vhibespoke",countries:["ireland"],format:"virtual",time:"Thursdays, 17:30-18:30 GMT",day:6,month:3,date:"6th onwards"},{id:15,n:"Financial Event with Paul Merriman",p:"financial",i:"ğŸ’°",desc:"Second session of financial wellbeing series with askpaul.",src:"vhibespoke",countries:["ireland"],format:"virtual",time:"13:00-14:00 GMT",day:19,month:3,date:"19th"},{id:16,n:"Desk Stretch & Mobility",p:"physical",i:"ğŸ¤¸",desc:"Quick desk-based stretches and mobility exercises for office workers.",src:"vhibespoke",countries:["ireland"],format:"virtual",day:12,month:3,date:"12th"},{id:17,n:"World Sleep Day",p:"physical",i:"ğŸ˜´",desc:"Understanding sleep hygiene and improving rest quality.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:14,month:3,date:"14th"},{id:18,n:"Menopause & Perimenopause Support",p:"physical",i:"ğŸŒ¸",desc:"Expert session on managing menopause symptoms and workplace support.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:11,month:3,date:"11th"},{id:19,n:"Women's History Month Events",p:"emotional",i:"ğŸ’œ",desc:"Month-long celebration of women's achievements with speaker series.",src:"erg",countries:["all"],key:true,erg:"Unity",format:"hybrid",day:1,month:3,date:"All Month"},{id:20,n:"Nudge Financial Wellbeing Webinar",p:"financial",i:"ğŸ“ˆ",desc:"Interactive financial wellbeing session for UK employees.",src:"nudge",countries:["uk"],format:"virtual",time:"13:00-14:00 GMT",day:4,month:3,date:"4th"},{id:21,n:"Global Day of Unplugging",p:"emotional",i:"ğŸ“µ",desc:"Digital wellness - encouraging time away from screens.",src:"benefits",countries:["all"],format:"virtual",day:7,month:3,date:"6-7th"},{id:22,n:"Transgender Day of Visibility",p:"emotional",i:"ğŸ³ï¸â€âš§ï¸",desc:"Supporting and celebrating transgender colleagues.",src:"erg",countries:["all"],erg:"Pride",format:"virtual",day:31,month:3,date:"31st"}]},April:{moment:"ğŸŒ± Thrive Heritage Month / World Autism Day (2nd) / Earth Day (22nd)",events:[{id:23,n:"6 Week HIIT Classes",p:"physical",i:"ğŸ‹ï¸",desc:"High-intensity interval training for all fitness levels.",src:"vhibespoke",countries:["ireland"],format:"virtual",time:"Tue & Fri, 12:15-12:45 GMT",day:1,month:4,date:"1st onwards"},{id:24,n:"6 Weeks Breathwork Program",p:"emotional",i:"ğŸŒ¬ï¸",desc:"Breathing techniques and stress management over 6 weeks.",src:"vhibespoke",countries:["ireland"],format:"virtual",day:9,month:4,date:"9th onwards"},{id:25,n:"Workplace Wellbeing Day",p:"emotional",i:"ğŸŒŸ",desc:"Celebrating workplace wellness with activities and resources.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:25,month:4,date:"25th"},{id:26,n:"World Health Day",p:"physical",i:"ğŸ©º",desc:"Global health awareness and wellness check reminders.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:7,month:4,date:"7th"},{id:27,n:"Thrive Heritage Month Events",p:"emotional",i:"ğŸŒ±",desc:"Celebrating neurodiversity and disability inclusion.",src:"erg",countries:["all"],key:true,erg:"Thrive",format:"hybrid",day:1,month:4,date:"All Month"},{id:28,n:"World Autism Awareness Day",p:"emotional",i:"ğŸ’™",desc:"Understanding autism in the workplace with resources.",src:"erg",countries:["all"],erg:"Thrive",format:"virtual",day:2,month:4,date:"2nd"},{id:29,n:"Earth Day Activities",p:"physical",i:"ğŸŒ",desc:"Global sustainability initiatives and clean-up events.",src:"erg",countries:["all"],format:"hybrid",day:22,month:4,date:"22nd"}]},May:{moment:"ğŸ§  AAPI Heritage Month / Mental Health Week (12-18th)",events:[{id:30,n:"Mental Health Awareness Event",p:"emotional",i:"ğŸ§ ",desc:"Expert speakers on mental wellbeing, resilience, and support.",src:"vhibespoke",countries:["ireland"],key:true,format:"hybrid",time:"10:00-12:00 GMT",room:"Dublin Town Hall & Virtual",day:14,month:5,date:"14th"},{id:31,n:"Chair Massage",p:"physical",i:"ğŸ’†",desc:"Relaxation massage during Mental Health Awareness Week.",src:"vhibespoke",countries:["ireland"],format:"onsite",time:"10:00-16:00 GMT",day:12,month:5,date:"12-16th"},{id:32,n:"4 Wellness Taster Sessions",p:"physical",i:"âœ¨",desc:"Sample different wellness activities: yoga, pilates, meditation.",src:"vhibespoke",countries:["ireland"],format:"virtual",day:5,month:5,date:"5th onwards"},{id:33,n:"Nutrition for Mental Health",p:"physical",i:"ğŸ¥—",desc:"How diet affects mood and mental wellbeing.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:20,month:5,date:"20th"},{id:34,n:"AAPI Heritage Month Events",p:"emotional",i:"ğŸŒ¸",desc:"Celebrating Asian American and Pacific Islander heritage.",src:"erg",countries:["all"],key:true,erg:"Rise",format:"hybrid",day:1,month:5,date:"All Month"},{id:35,n:"GAAD - Accessibility Day",p:"emotional",i:"â™¿",desc:"Global Accessibility Awareness Day: inclusive design.",src:"erg",countries:["all"],erg:"Thrive",format:"virtual",day:15,month:5,date:"15th"}]},June:{moment:"ğŸ³ï¸â€ğŸŒˆ Pride Month / Juneteenth (18th) / Windrush Day (26th)",events:[{id:36,n:"Summer Fitness Challenge",p:"physical",i:"â˜€ï¸",desc:"6-week summer wellness programme with team challenges.",src:"vhibespoke",countries:["ireland"],format:"hybrid",day:1,month:6,date:"1st onwards"},{id:37,n:"Pride Ireland Event",p:"emotional",i:"ğŸ³ï¸â€ğŸŒˆ",desc:"Dublin Pride celebrations including parade and networking.",src:"erg",countries:["ireland"],key:true,erg:"Pride",format:"onsite",time:"11:00-17:00",room:"Dublin City Centre",day:19,month:6,date:"19th"},{id:38,n:"Global Pride Events",p:"emotional",i:"ğŸ³ï¸â€ğŸŒˆ",desc:"Pride celebrations across all PayPal locations.",src:"erg",countries:["all"],key:true,erg:"Pride",format:"hybrid",day:1,month:6,date:"All Month"},{id:39,n:"Juneteenth Leadership Event",p:"emotional",i:"âœŠ",desc:"Commemorating Juneteenth with leadership panel.",src:"erg",countries:["all"],key:true,erg:"Amplify",format:"virtual",time:"16:00-17:30 GMT",day:18,month:6,date:"18th"},{id:40,n:"Windrush Day - Patrick Vernon OBE",p:"emotional",i:"ğŸš¢",desc:"Guest speaker celebrating Windrush generation.",src:"erg",countries:["all"],key:true,erg:"Amplify",format:"virtual",time:"14:00-15:30 GMT",day:26,month:6,date:"26th"},{id:41,n:"Impact Day Tag Rugby Blitz",p:"physical",i:"ğŸ‰",desc:"Team building sports event with tournament.",src:"sites",countries:["ireland"],format:"onsite",room:"Sandymount",day:11,month:6,date:"11-12th"},{id:42,n:"World Environment Day",p:"physical",i:"ğŸŒ¿",desc:"Environmental awareness and sustainability.",src:"benefits",countries:["all"],format:"virtual",day:5,month:6,date:"5th"}]},July:{moment:"ğŸ¤ International Friendship Day (30th)",events:[{id:43,n:"Let's Talk Men's Health Event",p:"physical",i:"ğŸ‘¨â€âš•ï¸",desc:"Men's health awareness: physical and mental health.",src:"vhibespoke",countries:["ireland"],key:true,format:"hybrid",time:"12:00-13:30 GMT",room:"Dublin Town Hall & Virtual",day:10,month:7,date:"10th"},{id:44,n:"6 Week Mindfulness Programme",p:"emotional",i:"ğŸ§˜",desc:"Weekly guided mindfulness and meditation sessions.",src:"vhibespoke",countries:["ireland"],format:"virtual",time:"Mondays, 08:00-08:30 GMT",day:7,month:7,date:"7th onwards"},{id:45,n:"Financial Confidence with askpaul",p:"financial",i:"ğŸ’°",desc:"Investing basics and long-term planning.",src:"vhicommunity",countries:["ireland"],format:"virtual",time:"13:00-14:00 GMT",day:16,month:7,date:"16th"},{id:46,n:"Fertility Support Session",p:"physical",i:"ğŸ‘¶",desc:"Support and resources for fertility journeys.",src:"erg",countries:["all"],format:"virtual",time:"10:00-11:00 GMT",day:9,month:7,date:"9th"},{id:47,n:"Climate Week & Sustainability",p:"physical",i:"ğŸŒ±",desc:"Sustainability activities and awareness.",src:"erg",countries:["all"],format:"hybrid",day:21,month:7,date:"2nd half"}]},August:{moment:"ğŸš€ World Entrepreneur Day (21st)",events:[{id:48,n:"Chair Massage",p:"physical",i:"ğŸ’†",desc:"15-minute relaxation massage sessions.",src:"vhibespoke",countries:["ireland"],format:"onsite",time:"10:00-16:00 GMT",room:"Dublin Quiet Room",day:19,month:8,date:"19-21st"},{id:49,n:"Energising Office Yoga",p:"physical",i:"ğŸ§˜",desc:"Quick desk-based yoga routines.",src:"vhibespoke",countries:["ireland"],format:"virtual",time:"Wednesdays, 15:00-15:20 GMT",day:6,month:8,date:"Wednesdays"},{id:50,n:"Understanding Neurodiversity: Parent's Guide",p:"emotional",i:"ğŸ§©",desc:"Support for parents of neurodiverse children.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:13,month:8,date:"13th"},{id:51,n:"What's in the Label - Nutrition",p:"physical",i:"ğŸ·ï¸",desc:"Understanding food labels and healthier choices.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:20,month:8,date:"20th"},{id:52,n:"Beach Clean & Eco Fair",p:"physical",i:"ğŸ–ï¸",desc:"Sustainability team building at Sandymount Beach.",src:"sites",countries:["ireland"],format:"onsite",time:"10:00-14:00 GMT",room:"Sandymount Beach",day:16,month:8,date:"16th"},{id:53,n:"World Entrepreneur Day",p:"financial",i:"ğŸš€",desc:"Celebrating entrepreneurship with resources.",src:"benefits",countries:["all"],format:"virtual",day:21,month:8,date:"21st"}]},September:{moment:"ğŸŒ® Latinx Heritage Month (15th-Oct 15th)",events:[{id:54,n:"Healthstation Screening",p:"physical",i:"ğŸ¥",desc:"Comprehensive onsite health screening with report.",src:"vhibespoke",countries:["ireland"],key:true,format:"onsite",time:"09:00-17:00 GMT",room:"Dublin Wellness Room",day:21,month:9,date:"21-28th"},{id:55,n:"Vhi 6 Week Strength Classes",p:"physical",i:"ğŸ’ª",desc:"Functional strength through resistance training.",src:"vhibespoke",countries:["ireland"],format:"virtual",time:"Mon & Thu, 12:15-12:45 GMT",day:1,month:9,date:"1st onwards"},{id:56,n:"Remote Gym: Sweat Strength Stamina",p:"physical",i:"ğŸƒ",desc:"Virtual fitness: cardio and strength.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:8,month:9,date:"8th onwards"},{id:57,n:"World Suicide Prevention Day",p:"emotional",i:"ğŸ’œ",desc:"Mental health awareness and crisis resources.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:10,month:9,date:"10th"},{id:58,n:"Nutrition Series: 4 Weeks Smarter Eating",p:"physical",i:"ğŸ¥—",desc:"Four-week nutrition programme.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:15,month:9,date:"15th onwards"},{id:59,n:"Latinx Heritage Month Events",p:"emotional",i:"ğŸŒ®",desc:"Celebrating Latinx culture and contributions.",src:"erg",countries:["all"],key:true,erg:"Aliados",format:"hybrid",day:15,month:9,date:"15th onwards"},{id:60,n:"World Cleanup Day",p:"physical",i:"ğŸ§¹",desc:"Global cleanup initiative.",src:"benefits",countries:["all"],format:"hybrid",day:19,month:9,date:"19th"}]},October:{moment:"ğŸ§  World Mental Health Day (10th) / Black History EMEA",events:[{id:61,n:"World Mental Health Day Keynote",p:"emotional",i:"ğŸ§ ",desc:"FLAGSHIP: Renowned speaker on mental wellbeing.",src:"vhibespoke",countries:["ireland"],key:true,format:"hybrid",time:"10:00-12:00 GMT",room:"Dublin Town Hall & Virtual",day:10,month:10,date:"10th"},{id:62,n:"6 Weeks Restorative Yoga",p:"physical",i:"ğŸ§˜",desc:"Gentle restorative yoga for relaxation.",src:"vhibespoke",countries:["ireland"],format:"virtual",time:"Fridays, 17:00-18:00 GMT",day:3,month:10,date:"3rd onwards"},{id:63,n:"Women's Wellness: Hormonal Health",p:"physical",i:"ğŸŒ¸",desc:"Understanding hormonal changes.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:15,month:10,date:"15th"},{id:64,n:"World Menopause Day: Pelvic Health",p:"physical",i:"ğŸ©º",desc:"Menopause awareness with pelvic health focus.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:18,month:10,date:"18th"},{id:65,n:"Black History Month EMEA Events",p:"emotional",i:"âœŠ",desc:"EMEA Black History Month celebrations.",src:"erg",countries:["all"],key:true,erg:"Amplify",format:"hybrid",day:1,month:10,date:"All Month"},{id:66,n:"Community Impact Grants",p:"emotional",i:"ğŸ‘",desc:"Supporting community initiatives through grants.",src:"erg",countries:["all"],format:"virtual",day:15,month:10,date:"15th"},{id:67,n:"Coming Out Day",p:"emotional",i:"ğŸ³ï¸â€ğŸŒˆ",desc:"Supporting LGBTQ+ colleagues and allies.",src:"erg",countries:["all"],erg:"Pride",format:"virtual",day:11,month:10,date:"11th"},{id:68,n:"Ada Lovelace Day",p:"emotional",i:"ğŸ‘©â€ğŸ’»",desc:"Celebrating women in STEM.",src:"erg",countries:["all"],erg:"Unity",format:"virtual",day:13,month:10,date:"13th"},{id:69,n:"Disability Employment Awareness",p:"emotional",i:"â™¿",desc:"Disability awareness and resources.",src:"benefits",countries:["all"],format:"virtual",day:1,month:10,date:"All Month"}]},November:{moment:"ğŸ–ï¸ Serve Heritage Month / Diwali (8th)",events:[{id:70,n:"International Men's Day Event",p:"physical",i:"ğŸ‘¨",desc:"Men's health issues and mental health support.",src:"vhibespoke",countries:["ireland"],key:true,format:"hybrid",time:"12:00-13:30 GMT",day:19,month:11,date:"19th"},{id:71,n:"Managing Diabetes",p:"physical",i:"ğŸ©º",desc:"Diabetes awareness, prevention, and management.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:13,month:11,date:"13th"},{id:72,n:"Financial Wellbeing: Build Confidence",p:"financial",i:"ğŸ’°",desc:"Year-end financial planning.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:20,month:11,date:"20th"},{id:73,n:"Serve Heritage Month Events",p:"emotional",i:"ğŸ–ï¸",desc:"Honouring military veterans and families.",src:"erg",countries:["all"],key:true,erg:"Serve",format:"hybrid",day:1,month:11,date:"All Month"},{id:74,n:"Diwali Celebration",p:"emotional",i:"ğŸª”",desc:"Festival of lights with traditional activities.",src:"erg",countries:["all"],erg:"Rise",format:"hybrid",day:8,month:11,date:"8th"},{id:75,n:"Global Entrepreneurship Week",p:"financial",i:"ğŸš€",desc:"Innovation and entrepreneurship resources.",src:"erg",countries:["all"],format:"virtual",day:16,month:11,date:"16-22nd"},{id:76,n:"Veterans Day",p:"emotional",i:"ğŸ–ï¸",desc:"Honouring veterans and their service.",src:"benefits",countries:["all"],format:"virtual",day:11,month:11,date:"11th"},{id:77,n:"World Kindness Day",p:"emotional",i:"ğŸ’–",desc:"Promoting kindness and wellbeing.",src:"benefits",countries:["all"],format:"virtual",day:13,month:11,date:"13th"},{id:78,n:"Transgender Day of Remembrance",p:"emotional",i:"ğŸ³ï¸â€âš§ï¸",desc:"Remembering transgender lives.",src:"erg",countries:["all"],erg:"Pride",format:"virtual",day:20,month:11,date:"20th"}]},December:{moment:"âœ¨ Believe Heritage Month / Giving Tuesday (1st)",events:[{id:79,n:"Winter Ready: Stay Safe",p:"physical",i:"ğŸŒ¨ï¸",desc:"Winter health and safety tips.",src:"vhibespoke",countries:["ireland"],format:"virtual",day:4,month:12,date:"4th"},{id:80,n:"Managing Holiday Stress",p:"emotional",i:"ğŸ„",desc:"Coping strategies for festive season.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:9,month:12,date:"9th"},{id:81,n:"Int'l Day of Persons with Disabilities",p:"emotional",i:"â™¿",desc:"Disability awareness and inclusion.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:3,month:12,date:"3rd"},{id:82,n:"Financial Wellbeing: New Year Planning",p:"financial",i:"ğŸ“…",desc:"Setting financial goals for 2027.",src:"vhicommunity",countries:["ireland"],format:"virtual",day:17,month:12,date:"17th"},{id:83,n:"Believe Heritage Month Events",p:"emotional",i:"âœ¨",desc:"Celebrating faith, spirituality, diverse beliefs.",src:"erg",countries:["all"],key:true,erg:"Believe",format:"hybrid",day:1,month:12,date:"All Month"},{id:84,n:"Giving Tuesday",p:"emotional",i:"ğŸ‘",desc:"Global charitable giving with matched donations.",src:"erg",countries:["all"],format:"hybrid",day:1,month:12,date:"1st"},{id:85,n:"World Meditation Day",p:"emotional",i:"ğŸ§˜",desc:"Global mindfulness with guided sessions.",src:"benefits",countries:["all"],format:"virtual",time:"08:00, 12:00, 17:00 GMT",day:21,month:12,date:"21st"},{id:86,n:"International Volunteer Day",p:"emotional",i:"ğŸ¤",desc:"Celebrating volunteering and community service.",src:"benefits",countries:["all"],format:"virtual",day:5,month:12,date:"5th"}]}};
const td=new Date(),cm=MN[td.getMonth()],cday=td.getDate(),cy=td.getFullYear();
function escHtml(s){return String(s??'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]))}
function safeUrl(u){try{const x=new URL(String(u),window.location.href);if(x.protocol==='http:'||x.protocol==='https:')return x.href}catch(e){}return ''}
function sanitizeColor(c){const s=String(c??'').trim();return/^#([0-9a-fA-F]{3}){1,2}$/.test(s)?s:'#64748B'}
function fdt(d){const dt=new Date(d);return dt.toLocaleDateString('en-GB',{day:'numeric',month:'long',year:'numeric'})+' at '+dt.toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'})}
function uft(){const f=document.getElementById('footerUpdate');f.textContent=lu?`Last Updated: ${fdt(lu)}${un?' by '+un:''}`:'Updated: January 2026'}
function saveUpdaterName(){un=document.getElementById('updaterName').value.trim();ss();st('Name saved','âœ…')}
function ru(){lu=new Date().toISOString();ss();uft()}
function ls(){try{const s=localStorage.getItem(SK);if(s){const d=JSON.parse(s);if(d.cfg)cfg=d.cfg;if(d.cd)cd=d.cd;if(d.eid)eid=d.eid;if(d.lu)lu=d.lu;if(d.un){un=d.un;const n=document.getElementById('updaterName');if(n)n.value=un}}}catch(e){}}
function ss(){try{localStorage.setItem(SK,JSON.stringify({cfg,cd,eid,lu,un}))}catch(e){}}
function st(m,i='âœ”'){const t=document.getElementById('toast');t.textContent='';const s=document.createElement('span');s.textContent=i;t.appendChild(s);t.appendChild(document.createTextNode(' '+m));t.classList.add('active');setTimeout(()=>t.classList.remove('active'),3000)}
function toggleTheme(){dm=!dm;document.documentElement.setAttribute('data-theme',dm?'dark':'light');document.getElementById('themeBtn').textContent=dm?'â˜€ï¸':'ğŸŒ™';st(dm?'Dark mode':'Light mode','ğŸ¨')}
function isPast(m,d){if(cy>2026)return true;if(cy<2026)return false;const mi=MN.indexOf(m);return mi<td.getMonth()||(mi===td.getMonth()&&d<cday)}
function toggleAdminMode(){am=!am;document.getElementById('adminPanel').classList.toggle('active',am);document.getElementById('adminBtn').classList.toggle('active',am);document.getElementById('adminBtn').textContent=am?'ğŸ”’ Exit':'âš™ï¸ Admin';document.body.classList.toggle('admin-mode',am);if(am){ral();const n=document.getElementById('updaterName');if(n&&un)n.value=un}rc();if(document.querySelector('.timeline-view.active'))rt();st(am?'Admin mode on':'Admin mode off','âš™ï¸')}
function switchAdminTab(t){document.querySelectorAll('.admin-tab').forEach(x=>x.classList.remove('active'));document.querySelectorAll('.admin-section').forEach(x=>x.classList.remove('active'));event.target.classList.add('active');document.getElementById(`admin-${t}`).classList.add('active');if(['hosts','countries','regions','pillars'].includes(t))ral()}
function rcp(id,sel,cb){document.getElementById(id).innerHTML=DC.map(c=>`<div class="color-option ${c===sel?'selected':''}" style="background:${c}" onclick="${cb}('${c}',this)"></div>`).join('')}
function ssc2(c,el){ssc=c;document.querySelectorAll('#sourceColorPicker .color-option').forEach(e=>e.classList.remove('selected'));el.classList.add('selected')}
function spc2(c,el){spc=c;document.querySelectorAll('#pillarColorPicker .color-option').forEach(e=>e.classList.remove('selected'));el.classList.add('selected')}
function ral(){let h='';for(let id in cfg.sources){const s=cfg.sources[id];h+=`<div class="settings-item"><div class="settings-item-color" style="background:${s.color}"></div><div class="settings-item-info"><div class="settings-item-name">${s.name}</div><div class="settings-item-id">${id} â€” ${s.desc||''}</div></div><button class="btn btn-danger" onclick="delSource('${id}')">ğŸ—‘ï¸</button></div>`}document.getElementById('hostsList').innerHTML=h||'<p>No hosts</p>';rcp('sourceColorPicker',ssc,'ssc2');h='';const sc=Object.entries(cfg.countries).sort((a,b)=>a[1].name.localeCompare(b[1].name));for(let[id,c]of sc){h+=`<div class="settings-item"><span style="font-size:1.3rem">${c.flag}</span><div class="settings-item-info"><div class="settings-item-name">${c.name}</div><div class="settings-item-id">${id} (${cfg.regions[c.region]?.name||c.region})</div></div><button class="btn btn-danger" onclick="delCountry('${id}')">ğŸ—‘ï¸</button></div>`}document.getElementById('countriesList').innerHTML=h||'<p>No countries</p>';h='';for(let id in cfg.regions){h+=`<div class="settings-item"><div class="settings-item-info"><div class="settings-item-name">${cfg.regions[id].name}</div><div class="settings-item-id">${id}</div></div><button class="btn btn-danger" onclick="delRegion('${id}')">ğŸ—‘ï¸</button></div>`}document.getElementById('regionsList').innerHTML=h||'<p>No regions</p>';h='';for(let id in cfg.pillars){const p=cfg.pillars[id];h+=`<div class="settings-item"><div class="settings-item-color" style="background:${p.color}">${p.icon}</div><div class="settings-item-info"><div class="settings-item-name">${p.name}</div><div class="settings-item-id">${id}</div></div><button class="btn btn-danger" onclick="delPillar('${id}')">ğŸ—‘ï¸</button></div>`}document.getElementById('pillarsList').innerHTML=h||'<p>No pillars</p>';rcp('pillarColorPicker',spc,'spc2');document.getElementById('newCountryRegion').innerHTML=Object.keys(cfg.regions).map(r=>`<option value="${r}">${cfg.regions[r].name}</option>`).join('')}
function addSource(){const id=document.getElementById('newSourceId').value.trim().toLowerCase().replace(/\s+/g,''),name=document.getElementById('newSourceName').value.trim(),desc=document.getElementById('newSourceDesc').value.trim();if(!id||!name)return st('Fill all fields','âš ï¸');cfg.sources[id]={name,color:ssc,desc};ru();ral();ud();document.getElementById('newSourceId').value='';document.getElementById('newSourceName').value='';document.getElementById('newSourceDesc').value='';st('Host added','âœ…')}
function delSource(id){if(confirm(`Delete ${cfg.sources[id]?.name}?`)){delete cfg.sources[id];ru();ral();ud();st('Deleted','ğŸ—‘ï¸')}}
function addCountry(){const id=document.getElementById('newCountryId').value.trim().toLowerCase().replace(/\s+/g,''),name=document.getElementById('newCountryName').value.trim(),flag=document.getElementById('newCountryFlag').value.trim(),region=document.getElementById('newCountryRegion').value;if(!id||!name||!flag)return st('Fill all fields','âš ï¸');cfg.countries[id]={name,flag,region};ru();ral();ud();document.getElementById('newCountryId').value='';document.getElementById('newCountryName').value='';document.getElementById('newCountryFlag').value='';st('Country added','âœ…')}
function delCountry(id){if(confirm(`Delete ${cfg.countries[id]?.name}?`)){delete cfg.countries[id];ru();ral();ud();st('Deleted','ğŸ—‘ï¸')}}
function addRegion(){const id=document.getElementById('newRegionId').value.trim().toLowerCase().replace(/\s+/g,''),name=document.getElementById('newRegionName').value.trim();if(!id||!name)return st('Fill all fields','âš ï¸');cfg.regions[id]={name};ru();ral();ud();document.getElementById('newRegionId').value='';document.getElementById('newRegionName').value='';st('Region added','âœ…')}
function delRegion(id){if(confirm(`Delete ${cfg.regions[id]?.name}?`)){delete cfg.regions[id];ru();ral();ud();st('Deleted','ğŸ—‘ï¸')}}
function addPillar(){const id=document.getElementById('newPillarId').value.trim().toLowerCase().replace(/\s+/g,''),name=document.getElementById('newPillarName').value.trim(),icon=document.getElementById('newPillarIcon').value.trim()||'ğŸ¯';if(!id||!name)return st('Fill all fields','âš ï¸');cfg.pillars[id]={name,icon,color:spc};ru();ral();ud();document.getElementById('newPillarId').value='';document.getElementById('newPillarName').value='';document.getElementById('newPillarIcon').value='';st('Pillar added','âœ…')}
function delPillar(id){if(confirm(`Delete ${cfg.pillars[id]?.name}?`)){delete cfg.pillars[id];ru();ral();ud();st('Deleted','ğŸ—‘ï¸')}}
function ud(){document.getElementById('regionFilter').innerHTML='<option value="all">All Regions</option>'+Object.keys(cfg.regions).map(r=>`<option value="${r}">${cfg.regions[r].name}</option>`).join('');document.getElementById('countryFilter').innerHTML='<option value="all">All Countries</option>'+Object.keys(cfg.countries).sort((a,b)=>cfg.countries[a].name.localeCompare(cfg.countries[b].name)).map(c=>`<option value="${c}">${cfg.countries[c].flag} ${cfg.countries[c].name}</option>`).join('');document.getElementById('sourceFilter').innerHTML='<option value="all">All Hosts</option>'+Object.keys(cfg.sources).map(s=>`<option value="${s}" title="${escHtml(cfg.sources[s].desc||'')}">${cfg.sources[s].name}</option>`).join('');document.getElementById('monthFilter').innerHTML='<option value="all">All Months</option>'+MN.map(m=>`<option value="${m}">${m}</option>`).join('');document.getElementById('pillarFilter').innerHTML='<option value="all">All Pillars</option>'+Object.keys(cfg.pillars).map(p=>`<option value="${p}">${cfg.pillars[p].icon} ${cfg.pillars[p].name}</option>`).join('');document.getElementById('adminMonth').innerHTML=MN.map(m=>`<option value="${m}">${m}</option>`).join('');document.getElementById('adminSource').innerHTML=Object.keys(cfg.sources).map(s=>`<option value="${s}">${cfg.sources[s].name}</option>`).join('');document.getElementById('adminPillar').innerHTML=Object.keys(cfg.pillars).map(p=>`<option value="${p}">${cfg.pillars[p].icon} ${cfg.pillars[p].name}</option>`).join('');document.getElementById('adminCountries').innerHTML='<option value="all">ğŸŒ Global</option>'+Object.keys(cfg.countries).sort((a,b)=>cfg.countries[a].name.localeCompare(cfg.countries[b].name)).map(c=>`<option value="${c}">${cfg.countries[c].flag} ${cfg.countries[c].name}</option>`).join('')}
function clearAdminForm(){['adminName','adminDay','adminDate','adminIcon','adminTime','adminRoom','adminContact','adminEmail','adminLink','adminDesc'].forEach(id=>document.getElementById(id).value='');document.getElementById('adminKey').value='false';document.getElementById('editingEventId').value='';Array.from(document.getElementById('adminCountries').options).forEach(o=>o.selected=false)}
function saveEvent(){const n=document.getElementById('adminName').value.trim(),m=document.getElementById('adminMonth').value,d=parseInt(document.getElementById('adminDay').value);if(!n||!m||!d)return st('Fill required fields','âš ï¸');const countries=Array.from(document.getElementById('adminCountries').selectedOptions).map(o=>o.value);const ev={id:document.getElementById('editingEventId').value?parseInt(document.getElementById('editingEventId').value):++eid,n,p:document.getElementById('adminPillar').value,i:document.getElementById('adminIcon').value||'ğŸ“…',desc:document.getElementById('adminDesc').value,src:document.getElementById('adminSource').value,countries:countries.length?countries:['all'],format:document.getElementById('adminFormat').value,time:document.getElementById('adminTime').value,room:document.getElementById('adminRoom').value,contact:document.getElementById('adminContact').value,email:document.getElementById('adminEmail').value,link:document.getElementById('adminLink').value,day:d,month:MN.indexOf(m)+1,date:document.getElementById('adminDate').value||d.toString(),key:document.getElementById('adminKey').value==='true'};const editId=document.getElementById('editingEventId').value;if(editId){const idx=cd[m].events.findIndex(e=>e.id==editId);if(idx>-1)cd[m].events[idx]=ev}else{if(!cd[m])cd[m]={moment:'',events:[]};cd[m].events.push(ev)}ru();clearAdminForm();rc();if(document.querySelector('.timeline-view.active'))rt();st(editId?'Event updated':'Event added','âœ…')}
function editEvent(id,m){const e=cd[m].events.find(ev=>ev.id==id);if(!e)return;document.getElementById('adminName').value=e.n;document.getElementById('adminMonth').value=m;document.getElementById('adminDay').value=e.day;document.getElementById('adminDate').value=e.date||'';document.getElementById('adminPillar').value=e.p;document.getElementById('adminSource').value=e.src;document.getElementById('adminFormat').value=e.format||'virtual';document.getElementById('adminIcon').value=e.i;document.getElementById('adminTime').value=e.time||'';document.getElementById('adminRoom').value=e.room||'';document.getElementById('adminContact').value=e.contact||'';document.getElementById('adminEmail').value=e.email||'';document.getElementById('adminLink').value=e.link||'';document.getElementById('adminDesc').value=e.desc||'';document.getElementById('adminKey').value=e.key?'true':'false';document.getElementById('editingEventId').value=e.id;const cs=document.getElementById('adminCountries');Array.from(cs.options).forEach(o=>o.selected=e.countries.includes(o.value));if(!document.getElementById('adminPanel').classList.contains('active')){document.getElementById('adminPanel').classList.add('active')}switchAdminTab('events');window.scrollTo({top:0,behavior:'smooth'});st('Editing...','âœï¸')}
function deleteEvent(id,m){if(!confirm('Delete this event?'))return;cd[m].events=cd[m].events.filter(e=>e.id!=id);ru();rc();if(document.querySelector('.timeline-view.active'))rt();st('Event deleted','ğŸ—‘ï¸')}
function downloadTemplate(){const csv='name,month,day,date_display,pillar,source,format,icon,time,location,contact,email,link,countries,key,description\n"Example",January,15,"15th",emotional,erg,virtual,ğŸ‰,"12:00 GMT","Virtual","John","john@example.com","","all",false,"Description"';const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'}));a.download='PayPal_Calendar_Template.csv';a.click();st('Template downloaded','ğŸ“¥')}
function bulkUpload(e){const file=e.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=function(ev){const lines=ev.target.result.split('\n').filter(l=>l.trim()&&!l.trim().startsWith('#'));if(lines.length<2)return st('No data','âš ï¸');const headers=lines[0].split(',').map(h=>h.trim().toLowerCase().replace(/"/g,''));let added=0;for(let i=1;i<lines.length;i++){try{const vals=lines[i].match(/(".*?"|[^,]+)/g)?.map(v=>v.replace(/^"|"$/g,'').trim())||[];if(vals.length<3)continue;const row={};headers.forEach((h,j)=>row[h]=vals[j]||'');if(!row.name||!row.month||!row.day)continue;const mi=MN.findIndex(m=>m.toLowerCase()===row.month.toLowerCase());if(mi===-1)continue;const countries=row.countries==='all'||!row.countries?['all']:row.countries.split(';').map(c=>c.trim().toLowerCase());const ev={id:++eid,n:row.name,p:row.pillar||'emotional',i:row.icon||'ğŸ“…',desc:row.description||'',src:row.source||'benefits',countries,format:row.format||'virtual',time:row.time||'',room:row.location||'',contact:row.contact||'',email:row.email||'',link:row.link||'',day:parseInt(row.day),month:mi+1,date:row.date_display||row.day,key:row.key==='true'};const mn=MN[mi];if(!cd[mn])cd[mn]={moment:'',events:[]};cd[mn].events.push(ev);added++}catch(err){}}ru();rc();st(`${added} events imported!`,'âœ…')};reader.readAsText(file);e.target.value=''}
function exportAllData(){const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([JSON.stringify({cfg,cd,eid,lu,un},null,2)],{type:'application/json'}));a.download='PayPal_Calendar_Backup.json';a.click();st('Exported','ğŸ“¥')}
function importData(e){const file=e.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=function(ev){try{const d=JSON.parse(ev.target.result);if(d.cfg)cfg=d.cfg;if(d.cd)cd=d.cd;if(d.eid)eid=d.eid;if(d.lu)lu=d.lu;if(d.un){un=d.un;document.getElementById('updaterName').value=un}ss();ud();rc();uft();st('Imported','ğŸ“¤')}catch{st('Invalid file','âŒ')}};reader.readAsText(file);e.target.value=''}
function resetToDefault(){if(confirm('Reset everything?')){localStorage.removeItem(SK);location.reload()}}
function exportCSV(){const events=gf();let csv='Name,Date,Month,Pillar,Format,Host,Countries,Time,Location,Contact,Email,Link,Description\n';events.forEach(e=>{const countries=e.countries.includes('all')?'Global':e.countries.map(c=>cfg.countries[c]?.name||c).join('; ');csv+=`"${e.n}","${e.date||e.day}","${e.monthName}","${e.p}","${e.format||''}","${cfg.sources[e.src]?.name||e.src}","${countries}","${e.time||''}","${e.room||''}","${e.contact||''}","${e.email||''}","${e.link||''}","${(e.desc||'').replace(/"/g,'""')}"\n`});const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'}));a.download='PayPal_Benefits_Calendar.csv';a.click();st('Exported','ğŸ“Š')}
function gf(){const region=document.getElementById('regionFilter').value,country=document.getElementById('countryFilter').value,source=document.getElementById('sourceFilter').value,month=document.getElementById('monthFilter').value,pillar=document.getElementById('pillarFilter').value,format=document.getElementById('formatFilter').value,search=document.getElementById('searchInput').value.toLowerCase();const months=month==='all'?MN:[month];let all=[];months.forEach(m=>{const data=cd[m];if(!data)return;data.events.forEach(e=>{if(kof&&!e.key)return;if(source!=='all'&&e.src!==source)return;if(pillar!=='all'&&e.p!==pillar)return;if(format!=='all'&&e.format!==format)return;if(search&&!e.n.toLowerCase().includes(search)&&!(e.desc&&e.desc.toLowerCase().includes(search)))return;if(country!=='all'&&!e.countries.includes('all')&&!e.countries.includes(country))return;if(region!=='all'){const rc=Object.keys(cfg.countries).filter(c=>cfg.countries[c].region===region);if(!e.countries.includes('all')&&!e.countries.some(c=>rc.includes(c)))return}all.push({...e,monthName:m})})});return all}
function openModal(e){ce=e;document.getElementById('modalTitle').textContent=`${e.i||'ğŸ“…'} ${e.n||'Event'}`;const hn=(cfg.sources[e.src]&&cfg.sources[e.src].name)?cfg.sources[e.src].name:(e.src||'');document.getElementById('modalSubtitle').textContent=`${e.monthName||MN[(e.month||1)-1]||''} ${e.date||e.day}, 2026 â€¢ ${hn}`;document.getElementById('modalDescription').textContent=e.desc||'No description available.';const det=document.getElementById('modalDetails');det.textContent='';function addDet(ic,lb,vl,lk){const w=document.createElement('div');w.className='modal-detail';const i=document.createElement('div');i.className='modal-detail-icon';i.textContent=ic;const tw=document.createElement('div');const l=document.createElement('div');l.className='modal-detail-label';l.textContent=lb;const v=document.createElement('div');v.className='modal-detail-value';if(lk){const a=document.createElement('a');a.href=lk;a.textContent=vl;if(lk.startsWith('http')){a.target='_blank';a.rel='noopener noreferrer'}v.appendChild(a)}else v.textContent=vl;tw.appendChild(l);tw.appendChild(v);w.appendChild(i);w.appendChild(tw);det.appendChild(w)}if(e.time)addDet('ğŸ•','Time',e.time);if(e.room)addDet('ğŸ“','Location',e.room);if(e.contact)addDet('ğŸ‘¤','Contact',e.contact);if(e.email)addDet('âœ‰ï¸','Email',e.email,'mailto:'+e.email);if(!det.childElementCount){const p=document.createElement('p');p.style.color='var(--pp-text-muted)';p.textContent='No additional details.';det.appendChild(p)}const ls=document.getElementById('modalLinkSection');ls.textContent='';const href=safeUrl(e.link);if(href){const bx=document.createElement('div');bx.className='event-link-box';const sp=document.createElement('span');sp.textContent='ğŸ”—';const a=document.createElement('a');a.href=href;a.target='_blank';a.rel='noopener noreferrer';a.textContent='Join: '+href;bx.appendChild(sp);bx.appendChild(a);ls.appendChild(bx)}const tags=document.getElementById('modalTags');tags.textContent='';const pl=cfg.pillars[e.p]||{name:e.p,icon:'',color:'#64748B'};const pc=sanitizeColor(pl.color);function addTag(txt,cn,st){const t=document.createElement('span');t.className='tag'+(cn?' '+cn:'');if(st)Object.keys(st).forEach(k=>t.style[k]=st[k]);t.textContent=txt;tags.appendChild(t)}addTag(`${pl.icon||''} ${pl.name||e.p}`,'',{background:pc+'20',color:pc});if(e.format)addTag(e.format,'',{background:'var(--pp-gray-100)',color:'var(--pp-text)'});if(e.key)addTag('â­ Key','tag-key');if(href)addTag('ğŸ”—','tag-link');if(e.countries&&e.countries.includes('all'))addTag('ğŸŒ Global','tag-country');else if(Array.isArray(e.countries))e.countries.slice(0,8).forEach(c=>{const o=cfg.countries[c];addTag(o?`${o.flag} ${o.name}`:c,'tag-country')});document.getElementById('eventModal').classList.add('active');document.getElementById('eventModal').setAttribute('aria-hidden','false')}
function closeModal(){document.getElementById('eventModal').classList.remove('active');document.getElementById('eventModal').setAttribute('aria-hidden','true')}
function parseTimeRange(s){if(!s)return null;const r=String(s).match(/(\d{1,2})[:.](\d{2})\s*(am|pm)?\s*[-â€“to]+\s*(\d{1,2})[:.](\d{2})\s*(am|pm)?/i);const to24=(h,ap)=>{h=parseInt(h);if(!ap)return h;ap=ap.toLowerCase();if(ap==='pm'&&h<12)return h+12;if(ap==='am'&&h===12)return 0;return h};if(r)return{sh:to24(r[1],r[3]),sm:parseInt(r[2]),eh:to24(r[4],r[6]),em:parseInt(r[5])};const sg=String(s).match(/(\d{1,2})[:.](\d{2})\s*(am|pm)?/i);if(sg)return{sh:to24(sg[1],sg[3]),sm:parseInt(sg[2]),eh:null,em:null};return null}
function eventStartEnd(e){const start=new Date(2026,(e.month||1)-1,e.day||1,10,0);let end=new Date(start.getTime()+3600000);const tr=parseTimeRange(e.time);if(tr){start.setHours(tr.sh,tr.sm,0,0);if(tr.eh!==null){end=new Date(2026,(e.month||1)-1,e.day||1,tr.eh,tr.em,0);if(end<=start)end=new Date(start.getTime()+3600000)}}return{start,end}}
function addToOutlook(){if(!ce)return;const{start,end}=eventStartEnd(ce);const p=(n)=>String(n).padStart(2,'0');const fmt=(dt)=>`${dt.getFullYear()}-${p(dt.getMonth()+1)}-${p(dt.getDate())}T${p(dt.getHours())}:${p(dt.getMinutes())}:00`;window.open(`https://outlook.office.com/calendar/0/deeplink/compose?path=/calendar/action/compose&rru=addevent&allday=false&startdt=${encodeURIComponent(fmt(start))}&enddt=${encodeURIComponent(fmt(end))}&subject=${encodeURIComponent(ce.n||'Event')}&body=${encodeURIComponent(((ce.desc||'')+'\n\n'+(ce.link?'Join: '+ce.link:'')).trim())}&location=${encodeURIComponent(ce.room||'Virtual')}`,'_blank')}
function addToGoogle(){if(!ce)return;const{start,end}=eventStartEnd(ce);const g=(dt)=>dt.toISOString().replace(/[-:]/g,'').replace(/\.\d{3}/,'');window.open(`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(ce.n||'Event')}&details=${encodeURIComponent(((ce.desc||'')+'\n\n'+(ce.link?'Join: '+ce.link:'')).trim())}&location=${encodeURIComponent(ce.room||'Virtual')}&dates=${g(start)}/${g(end)}`,'_blank')}
function rs(events){const key=events.filter(e=>e.key).length,virt=events.filter(e=>e.format==='virtual').length,onsite=events.filter(e=>e.format==='onsite').length;document.getElementById('quickStats').innerHTML=`<div class="quick-stats-left"><div class="quick-stat" title="Total number of events matching current filters"><div class="quick-stat-icon">ğŸ“…</div><div><div class="quick-stat-value">${events.length}</div><div class="quick-stat-label">Total</div></div></div><div class="quick-stat" title="Number of key/flagship events"><div class="quick-stat-icon">â­</div><div><div class="quick-stat-value">${key}</div><div class="quick-stat-label">Key</div></div></div><div class="quick-stat" title="Number of virtual/online events"><div class="quick-stat-icon">ğŸ’»</div><div><div class="quick-stat-value">${virt}</div><div class="quick-stat-label">Virtual</div></div></div><div class="quick-stat" title="Number of onsite/in-person events"><div class="quick-stat-icon">ğŸ¢</div><div><div class="quick-stat-value">${onsite}</div><div class="quick-stat-label">Onsite</div></div></div></div><div class="quick-stats-right"><div class="key-filter"><label title="Toggle to show only key/flagship events">â­ Key Only</label><label class="toggle-switch" title="Show only key events"><input type="checkbox" id="keyOnlyToggle" onchange="toggleKeyOnly()"><span class="toggle-slider"></span></label></div><button class="btn-reset-bar" onclick="resetFilters()" title="Clear all filters and search to show all events">â†º Reset Filters</button></div>`;document.getElementById('keyOnlyToggle').checked=kof;document.getElementById('footerStats').innerHTML=`<div class="footer-stat"><div class="footer-stat-value">${events.length}</div><div class="footer-stat-label">Events</div></div><div class="footer-stat"><div class="footer-stat-value">${key}</div><div class="footer-stat-label">Key</div></div>`}
function toggleKeyOnly(){kof=document.getElementById('keyOnlyToggle').checked;rc();if(document.querySelector('.timeline-view.active'))rt();if(document.querySelector('.dashboard-view.active'))rd()}
function toggleMonth(m){const card=document.querySelector(`[data-month="${m}"]`);if(card){card.classList.toggle('collapsed');const hdr=card.querySelector('.month-header');if(hdr)hdr.setAttribute('aria-expanded',!card.classList.contains('collapsed'))}}
function rc(){const events=gf(),month=document.getElementById('monthFilter').value,months=month==='all'?MN:[month];const eByM={};months.forEach(m=>eByM[m]=[]);events.forEach(e=>{if(eByM[e.monthName])eByM[e.monthName].push(e)});let html='';months.forEach(m=>{const data=cd[m];if(!data)return;const evs=(eByM[m]||[]).slice().sort((a,b)=>a.day-b.day);const isCurrent=m===cm&&cy===2026,isPastMonth=cy===2026&&MN.indexOf(m)<td.getMonth(),expanded=!isPastMonth;html+=`<div class="month-card ${isCurrent?'current-month':''} ${isPastMonth?'collapsed':''}" data-month="${m}"><button type="button" class="month-header" data-month-toggle="${m}" aria-expanded="${expanded}" title="Click to expand or collapse ${m}"><span class="month-name"><span class="collapse-icon">â–¼</span> ${m}${isCurrent?'<span class="current-month-badge">ğŸ“ Current</span>':''}</span><span class="month-badge">${evs.length}</span></button>${data.moment?`<div class="month-moment">${escHtml(data.moment)}</div>`:''}<div class="events-list">${evs.length===0?'<div class="no-events">No events match filters</div>':evs.map(e=>{const sc=cfg.sources[e.src]||{name:e.src,color:'#666'};const dc=sanitizeColor(sc.color);const countries=(e.countries&&e.countries.includes('all'))?'ğŸŒ':(e.countries||[]).slice(0,3).map(c=>(cfg.countries[c]||{}).flag||'').join('');const past=isPast(m,e.day);const pc=cfg.pillars[e.p]||{name:e.p,color:'#666'};const pC=sanitizeColor(pc.color);const lk=safeUrl(e.link);return`<div class="event ${e.key?'key':''} ${past?'past-event':''}" data-event-id="${e.id}" data-month="${m}"><div class="event-header"><span class="event-icon">${escHtml(e.i||'ğŸ“…')}</span><div class="event-content"><div class="event-title">${escHtml(e.n)}</div><div class="event-meta">${e.date?`<span class="tag tag-date">${escHtml(e.date)}</span>`:''}<span class="tag" style="background:${pC}20;color:${pC}">${escHtml(pc.name||e.p)}</span><span class="event-host-tag" style="border-left-color:${dc};background:${dc}10;color:${dc}" title="${escHtml(sc.desc||sc.name)}">${escHtml(sc.name)}</span>${lk?'<span class="tag tag-link">ğŸ”—</span>':''}<span class="tag tag-country">${escHtml(countries)}</span></div><div class="event-cta">${lk?`<a class="event-cta-btn primary" href="${escHtml(lk)}" target="_blank" rel="noopener noreferrer" title="Register or join this event">Register</a>`:''}<button type="button" class="event-cta-btn secondary" data-action="details" title="View full event details">Details</button></div></div><div class="event-actions"><button class="btn btn-secondary" onclick="event.stopPropagation();editEvent(${e.id},'${m}')" title="Edit this event">âœï¸</button><button class="btn btn-danger" onclick="event.stopPropagation();deleteEvent(${e.id},'${m}')" title="Delete this event">ğŸ—‘ï¸</button></div></div></div>`}).join('')}</div></div>`});document.getElementById('calendarGrid').innerHTML=html;rs(events)}
function rt(){const events=gf().slice().sort((a,b)=>a.month-b.month||a.day-b.day);let html='',lastM='';const mc={};events.forEach(e=>{mc[e.monthName]=(mc[e.monthName]||0)+1});events.forEach(e=>{if(e.monthName!==lastM){html+=`<div class="timeline-month-header"><span>ğŸ“… ${e.monthName} 2026</span><span class="month-count">${mc[e.monthName]} events</span></div>`;lastM=e.monthName}const pc=cfg.pillars[e.p]||{name:e.p,icon:'',color:'#666'},sc=cfg.sources[e.src]||{name:e.src,color:'#666'};const pC=sanitizeColor(pc.color),sC=sanitizeColor(sc.color);const countries=(e.countries&&e.countries.includes('all'))?'ğŸŒ Global':(e.countries||[]).slice(0,3).map(c=>(cfg.countries[c]||{}).flag||'').join(' ');html+=`<div class="timeline-event ${e.key?'key':''}" data-event-id="${e.id}" data-month="${e.monthName}"><div class="timeline-event-header"><span class="timeline-event-icon">${escHtml(e.i||'ğŸ“…')}</span><div class="timeline-event-content"><div class="timeline-event-title">${escHtml(e.n)}${e.key?' â­':''}${safeUrl(e.link)?' ğŸ”—':''}</div><div class="timeline-event-meta"><span style="background:var(--pp-navy);color:#fff;padding:2px 8px;border-radius:4px">${escHtml(e.date||e.day)}</span><span style="background:${pC}20;color:${pC};padding:2px 8px;border-radius:4px">${escHtml((pc.icon||'')+' '+(pc.name||e.p))}</span><span style="background:var(--pp-gray-100);color:var(--pp-text);padding:2px 8px;border-radius:4px">${escHtml(e.format||'virtual')}</span><span style="color:var(--pp-text-muted)">${escHtml(countries)}</span></div><div class="timeline-event-host" style="border-left-color:${sC}" title="${escHtml(sc.desc||sc.name)}"><span class="host-dot" style="background:${sC}"></span>Hosted by ${escHtml(sc.name)}</div>${e.time?`<div class="timeline-event-time">ğŸ• ${escHtml(e.time)}</div>`:''}<div class="timeline-event-actions"><button class="btn btn-secondary" onclick="event.stopPropagation();editEvent(${e.id},'${e.monthName}')" title="Edit this event">âœï¸ Edit</button><button class="btn btn-danger" onclick="event.stopPropagation();deleteEvent(${e.id},'${e.monthName}')" title="Delete this event">ğŸ—‘ï¸ Delete</button></div></div></div></div>`});document.getElementById('timelineContainer').innerHTML=events.length?html:'<p style="text-align:center;color:var(--pp-text-muted);padding:40px">No events match current filters</p>'}
function rd(){const events=gf(),byPillar={},bySource={},byCountry={},byMonth={},byFormat={virtual:0,onsite:0,hybrid:0};Object.keys(cfg.pillars).forEach(p=>byPillar[p]=0);MN.forEach(m=>byMonth[m]=0);events.forEach(e=>{byPillar[e.p]=(byPillar[e.p]||0)+1;bySource[e.src]=(bySource[e.src]||0)+1;e.countries.forEach(c=>byCountry[c]=(byCountry[c]||0)+1);byMonth[e.monthName]=(byMonth[e.monthName]||0)+1;byFormat[e.format||'virtual']++});const maxMonth=Math.max(...Object.values(byMonth),1);document.getElementById('dashboardGrid').innerHTML=`<div class="dash-card span-12"><h4>ğŸ“Š Overview</h4><div class="stat-grid"><div class="stat-box"><div class="value" style="color:var(--pp-navy)">${events.length}</div><div class="label">Total Events</div></div><div class="stat-box"><div class="value" style="color:#00CF92">${events.filter(e=>e.key).length}</div><div class="label">Key Events</div></div><div class="stat-box"><div class="value" style="color:#22C55E">${events.filter(e=>e.link).length}</div><div class="label">With Links</div></div><div class="stat-box"><div class="value" style="color:var(--pp-blue)">${byCountry['all']||0}</div><div class="label">Global Events</div></div></div></div><div class="dash-card span-4"><h4>ğŸ¯ By Pillar</h4>${Object.entries(byPillar).map(([id,c])=>{const p=cfg.pillars[id]||{},pct=events.length?Math.round(c/events.length*100):0;return`<div class="progress-item"><div class="progress-header"><span class="icon">${p.icon||''}</span><span class="name">${p.name||id}</span><span class="count">${c}</span><span class="pct">(${pct}%)</span></div><div class="progress-bar"><div class="progress-fill" style="width:${pct}%;background:${p.color||'#666'}"></div></div></div>`}).join('')}</div><div class="dash-card span-4"><h4>ğŸ“ By Format</h4><div class="format-grid">${Object.entries(byFormat).map(([f,c])=>{const icons={virtual:'ğŸ’»',onsite:'ğŸ¢',hybrid:'ğŸ”„'},colors={virtual:'#0070BA',onsite:'#22C55E',hybrid:'#009CDE'};return`<div class="format-box" style="border-left-color:${colors[f]}"><div class="icon">${icons[f]}</div><div class="value">${c}</div><div class="label">${f}</div></div>`}).join('')}</div></div><div class="dash-card span-4"><h4>ğŸŒ Top Countries</h4>${Object.entries(byCountry).filter(([k])=>k!=='all').sort((a,b)=>b[1]-a[1]).slice(0,6).map(([id,c])=>`<div class="country-item"><span class="flag">${cfg.countries[id]?.flag||'ğŸŒ'}</span><span class="name">${cfg.countries[id]?.name||id}</span><span class="badge">${c}</span></div>`).join('')}</div><div class="dash-card span-6"><h4>ğŸ¢ By Host</h4>${Object.entries(bySource).sort((a,b)=>b[1]-a[1]).map(([id,c])=>{const s=cfg.sources[id]||{},pct=events.length?Math.round(c/events.length*100):0;return`<div class="host-item" title="${escHtml(s.desc||'')}"><span class="dot" style="background:${s.color||'#ccc'}"></span><span class="name">${s.name||id}</span><span class="count">${c}</span><span class="pct">(${pct}%)</span></div>`}).join('')}</div><div class="dash-card span-6"><h4>ğŸ“… Events by Month</h4><div class="month-chart">${MN.map(m=>{const c=byMonth[m]||0,h=c?Math.round(c/maxMonth*100):5,isCurrent=m===cm;return`<div class="month-bar"><div class="bar" style="height:${h}px;background:${isCurrent?'var(--pp-blue)':'var(--pp-gray-300)'}"></div><div class="label">${m.slice(0,3)}</div><div class="count">${c}</div></div>`}).join('')}</div></div>`}
function resetFilters(){['regionFilter','countryFilter','sourceFilter','monthFilter','pillarFilter','formatFilter'].forEach(id=>document.getElementById(id).value='all');document.getElementById('searchInput').value='';kof=false;rc();if(document.querySelector('.timeline-view.active'))rt();if(document.querySelector('.dashboard-view.active'))rd();st('Filters reset','â†º')}
document.querySelectorAll('.view-btn').forEach(btn=>btn.addEventListener('click',function(){document.querySelectorAll('.view-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');const v=this.dataset.view;document.querySelectorAll('.calendar-view,.timeline-view,.dashboard-view').forEach(x=>x.classList.remove('active'));document.querySelector(`.${v}-view`).classList.add('active');if(v==='timeline')rt();if(v==='dashboard')rd()}));
['regionFilter','countryFilter','sourceFilter','monthFilter','pillarFilter','formatFilter'].forEach(id=>document.getElementById(id).addEventListener('change',()=>{rc();if(document.querySelector('.timeline-view.active'))rt();if(document.querySelector('.dashboard-view.active'))rd()}));
document.getElementById('searchInput').addEventListener('input',()=>{rc();if(document.querySelector('.timeline-view.active'))rt();if(document.querySelector('.dashboard-view.active'))rd()});
document.getElementById('regionFilter').addEventListener('change',function(){const r=this.value,cf=document.getElementById('countryFilter');cf.innerHTML='<option value="all">All Countries</option>';(r==='all'?Object.keys(cfg.countries):Object.keys(cfg.countries).filter(c=>cfg.countries[c].region===r)).sort((a,b)=>cfg.countries[a].name.localeCompare(cfg.countries[b].name)).forEach(c=>cf.innerHTML+=`<option value="${c}">${cfg.countries[c].flag} ${cfg.countries[c].name}</option>`)});
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeModal()});
document.querySelectorAll('.modal-overlay').forEach(o=>o.addEventListener('click',e=>{if(e.target===o)o.classList.remove('active')}));
document.getElementById('calendarGrid').addEventListener('click',ev=>{const toggle=ev.target.closest('[data-month-toggle]');if(toggle){toggleMonth(toggle.getAttribute('data-month-toggle'));return}const db=ev.target.closest('[data-action="details"]');if(db){const el=db.closest('.event');if(el){const e=gf().find(x=>x.id===parseInt(el.getAttribute('data-event-id'))&&x.monthName===el.getAttribute('data-month'));if(e)openModal(e)}return}if(ev.target.closest('a,button'))return;const el=ev.target.closest('.event');if(el){const e=gf().find(x=>x.id===parseInt(el.getAttribute('data-event-id'))&&x.monthName===el.getAttribute('data-month'));if(e)openModal(e)}});
document.getElementById('timelineContainer').addEventListener('click',ev=>{if(ev.target.closest('a,button'))return;const el=ev.target.closest('.timeline-event');if(el){const e=gf().find(x=>x.id===parseInt(el.getAttribute('data-event-id'))&&x.monthName===el.getAttribute('data-month'));if(e)openModal(e)}});
ls();ud();rc();uft();
</script>
</body>
</html>